(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    102669,       2425]
NotebookOptionsPosition[     98908,       2289]
NotebookOutlinePosition[     99319,       2307]
CellTagsIndexPosition[     99276,       2304]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Half Rod, Albedo Problem, Isotropic Scattering", "Title",
 CellChangeTimes->{{3.61742787362737*^9, 3.617427885266508*^9}, {
  3.619592656668026*^9, 3.619592662680479*^9}}],

Cell["Exponential Random Flight", "Subtitle",
 CellChangeTimes->{{3.619594484416584*^9, 3.6195944880949802`*^9}}],

Cell[TextData[{
 "This is code to accompany the book:\n",
 StyleBox["A Hitchhiker\[CloseCurlyQuote]s Guide to Multiple Scattering\n", 
  "Subchapter"],
 StyleBox["\[Copyright]", "Subsection"],
 StyleBox[" ", "Subsection"],
 StyleBox["2015", "Subsection"],
 StyleBox[" ", "Section"],
 StyleBox["Eugene d\[CloseCurlyQuote]Eon \nwww.eugenedeon.com", "Subsection"]
}], "Text",
 CellChangeTimes->{{3.6174286022468777`*^9, 3.617428710592918*^9}, {
  3.6410039396211576`*^9, 3.641003945296226*^9}, {3.645060407236547*^9, 
  3.645060444609275*^9}}],

Cell[CellGroupData[{

Cell["Path Setup", "Section",
 CellChangeTimes->{{3.640928920990849*^9, 3.64092892141395*^9}, {
  3.640928986491934*^9, 3.640928986905283*^9}}],

Cell["\<\
Put a file at ~/.hitchhikerpath with the path to your hitchhiker repo so that \
these worksheets can find the MC data from the C++ simulations for \
verification\
\>", "Text",
 CellChangeTimes->{{3.640928926126832*^9, 3.6409289600754013`*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"Import", "[", "\"\<~/.hitchhikerpath\>\"", "]"}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notation", "Section",
 CellChangeTimes->{{3.617428538130481*^9, 3.617428538753331*^9}}],

Cell["\<\
\[Alpha] - single-scattering albedo
\[CapitalSigma]t - extinction coefficient
x - position coordinate in rod (source at x = 0)\
\>", "Text",
 CellChangeTimes->{{3.617428487341361*^9, 3.617428516514864*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analytic solutions", "Section",
 CellChangeTimes->{{3.617428019371695*^9, 3.6174280209794273`*^9}}],

Cell[CellGroupData[{

Cell["Half rod reflectance/albedo (R)", "Subsection",
 CellChangeTimes->{{3.621358061851241*^9, 3.621358063377636*^9}, {
  3.64291416791686*^9, 3.6429141684669037`*^9}, {3.642914333967946*^9, 
  3.6429143355347443`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`R", "[", "\[Alpha]_", "]"}], ":=", 
  RowBox[{"2", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "\[Alpha]"}], "2"], "-", 
      SqrtBox[
       RowBox[{"1", "-", "\[Alpha]"}]], "+", "1"}], ")"}], 
    "\[Alpha]"]}]}]}], "Input",
 CellChangeTimes->{{3.61959293187952*^9, 3.619592988486793*^9}, {
   3.643952897091851*^9, 3.643952909827197*^9}, 3.645060596153613*^9, {
   3.6462769500975237`*^9, 3.646276953883354*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"halfrodalbedoisoscatter`R", "[", "\[Alpha]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.64395301276322*^9, 3.6439530159736977`*^9}, 
   3.646277409414596*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["\[Alpha]", "4"], "+", 
   FractionBox[
    SuperscriptBox["\[Alpha]", "2"], "8"], "+", 
   FractionBox[
    RowBox[{"5", " ", 
     SuperscriptBox["\[Alpha]", "3"]}], "64"], "+", 
   FractionBox[
    RowBox[{"7", " ", 
     SuperscriptBox["\[Alpha]", "4"]}], "128"], "+", 
   FractionBox[
    RowBox[{"21", " ", 
     SuperscriptBox["\[Alpha]", "5"]}], "512"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Alpha]", "]"}], "6"],
    SeriesData[$CellContext`\[Alpha], 0, {}, 1, 6, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Alpha], 0, {
    Rational[1, 4], 
    Rational[1, 8], 
    Rational[5, 64], 
    Rational[7, 128], 
    Rational[21, 512]}, 1, 6, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.643953013423473*^9, 3.643953016768423*^9}, 
   3.6439531274961863`*^9, 3.6450666661383247`*^9, 3.6450701608233*^9, 
   3.646173975289732*^9, 3.646254686939445*^9, 3.646262947087016*^9, 
   3.646272134709774*^9, 3.6462726782631474`*^9, 3.646277219348131*^9, {
   3.646277409763979*^9, 3.64627741367945*^9}, 3.6486939520456953`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`R", "[", 
   RowBox[{"\[Alpha]_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "n"], "2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "n"], 
   RowBox[{"Binomial", "[", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", 
     RowBox[{"n", "+", "1"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6439530290024643`*^9, 3.643953031241785*^9}, 
   3.6462769654525433`*^9, 3.646277429964838*^9, {3.6486939293712587`*^9, 
   3.6486939466857233`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Internal distribution, \[OpenCurlyQuote]radiance\[CloseCurlyQuote]", \
"Subsection",
 CellChangeTimes->{{3.6174307357157917`*^9, 3.617430742507958*^9}, {
  3.642914351600622*^9, 3.6429143572131147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`LR", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_"}], "]"}], ":=", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SqrtBox[
      RowBox[{"1", "-", "\[Alpha]"}]]}], " ", "\[CapitalSigma]t", " ", "x"}]],
   " "}]], "Input",
 CellChangeTimes->{{3.617430690623348*^9, 3.6174307057929173`*^9}, {
   3.617430826778767*^9, 3.617430831298792*^9}, {3.619594091183975*^9, 
   3.619594114394599*^9}, 3.6462769749823427`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`LL", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[CapitalSigma]t"}], " ", 
      SqrtBox[
       RowBox[{"1", "-", "\[Alpha]"}]], "x"}], "]"}]}], 
   RowBox[{
    RowBox[{"-", "\[Alpha]"}], "+", 
    RowBox[{"2", 
     SqrtBox[
      RowBox[{"1", "-", "\[Alpha]"}]]}], "+", "2"}]]}]], "Input",
 CellChangeTimes->{{3.617430716019354*^9, 3.617430719357438*^9}, {
   3.61743083377562*^9, 3.617430837914253*^9}, {3.619594163099494*^9, 
   3.6195941960739183`*^9}, 3.6462769758513393`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fluence", "Subsection",
 CellChangeTimes->{{3.6174280405395184`*^9, 3.617428041266676*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`\[Phi]", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"halfrodalbedoisoscatter`LR", "[", 
    RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], "+", 
   RowBox[{"halfrodalbedoisoscatter`LL", "[", 
    RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.61742826600518*^9, 3.617428300462263*^9}, {
   3.6174283455645227`*^9, 3.617428382979632*^9}, {3.619594141002194*^9, 
   3.619594157053108*^9}, {3.646276978139011*^9, 3.646276979698987*^9}, 
   3.646277313980769*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided fluence", "Subsection",
 CellChangeTimes->{{3.621358084801984*^9, 3.6213580888724403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`\[Phi]", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "n_"}], 
   "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "n"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"halfrodalbedoisoscatter`\[Phi]", "[", 
        RowBox[{"x", ",", "A", ",", "\[CapitalSigma]t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "0", ",", "n"}], "}"}]}], "]"}], "/.", 
     RowBox[{"A", "\[Rule]", "\[Alpha]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.621359852120468*^9, 3.621359891634035*^9}, {
  3.645060658264719*^9, 3.645060660751495*^9}, {3.646276985419786*^9, 
  3.64627698925959*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moments", "Subsection",
 CellChangeTimes->{{3.642914372613346*^9, 3.642914373284243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`\[Phi]m", "[", 
   RowBox[{"\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "k_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["k", "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SqrtBox[
       RowBox[{"1", "-", "\[Alpha]"}]], "+", "\[Alpha]"}], ")"}], " ", 
    SuperscriptBox["\[CapitalSigma]t", 
     RowBox[{
      RowBox[{"-", "1"}], "-", "k"}]], " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"1", "+", "k"}], "]"}]}], "\[Alpha]"]}]], "Input",
 CellChangeTimes->{{3.6257609784356527`*^9, 3.62576099570722*^9}, 
   3.646276992027254*^9}],

Cell["Only accurate for n even", "Text",
 CellChangeTimes->{{3.64506907595159*^9, 3.6450690795903254`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`\[Phi]m", "[", 
   RowBox[{"\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "k_", ",", "n_"}], 
   "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "n"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "n"], " ", 
      SuperscriptBox["\[CapitalSigma]t", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "k"}]], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"1", "+", "k"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"2", "+", "n"}], ")"}]}], " ", 
         RowBox[{"Gamma", "[", 
          FractionBox[
           RowBox[{"1", "-", "k"}], "2"], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "+", "n"}], ")"}], " ", 
            RowBox[{"Binomial", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["k", "2"]}], ",", 
              RowBox[{"1", "+", "n"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "n"}], ")"}], " ", 
            RowBox[{"Binomial", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["k", "2"]}], ",", 
              RowBox[{"2", "+", "n"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], "-", 
           FractionBox["k", "2"], "-", "n"}], "]"}], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"2", "+", "n"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "-", 
        FractionBox["k", "2"], "-", "n"}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"3", "+", "n"}], "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6450611342022667`*^9, 3.6450611397954493`*^9}, {
   3.6450688679851513`*^9, 3.645068871838372*^9}, 3.646276993739078*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["load MC data", "Section",
 CellChangeTimes->{{3.617427964847665*^9, 3.617427965662361*^9}, {
  3.6174280073412037`*^9, 3.617428007556081*^9}, {3.640936210100869*^9, 
  3.640936211771452*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`ppoints", "[", 
   RowBox[{"xs_", ",", "dx_", ",", "maxx_", ",", "\[CapitalSigma]t_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"dx", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", 
        RowBox[{"0.5", "dx"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "\[CapitalSigma]t"}], ")"}], 
        RowBox[{"xs", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", 
     RowBox[{"-", "2"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.617848413386137*^9, 3.6178484581160173`*^9}, {
   3.61959273772493*^9, 3.6195927529849243`*^9}, 3.6462769978320913`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`fs", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\<code/rod/halfrod/albedoProblem/data/halfrod_albedoproblem_\
isotropicscatter_exp*\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.617431703558316*^9, 3.61743173077596*^9}, {
   3.61959282254521*^9, 3.6195928356726227`*^9}, {3.6409361975771008`*^9, 
   3.640936201348721*^9}, 3.645065566454424*^9, 3.646276999345551*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"halfrodalbedoisoscatter`index", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"x", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalSigma]t", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "11"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "data"}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"halfrodalbedoisoscatter`simulations", "=", 
   RowBox[{
   "halfrodalbedoisoscatter`index", "/@", "halfrodalbedoisoscatter`fs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.645065231793377*^9, 3.645065296029221*^9}, {
   3.6450653296918097`*^9, 3.6450653865106487`*^9}, 3.6450654361720257`*^9, {
   3.6462770009307747`*^9, 3.646277007281083*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"halfrodalbedoisoscatter`alphas", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
    "halfrodalbedoisoscatter`simulations"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.645065448960425*^9, 3.6450654746981783`*^9}, {
  3.646277017777326*^9, 3.646277020560364*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.1`", ",", "0.3`", ",", "0.5`", ",", "0.7`", ",", "0.9`", ",", "0.95`", 
   ",", "0.98`", ",", "0.99`", ",", "0.999`"}], "}"}]], "Output",
 CellChangeTimes->{{3.6450654647633867`*^9, 3.645065474997116*^9}, 
   3.645070161322473*^9, 3.64617397571076*^9, 3.646254687365184*^9, 
   3.64626294753141*^9, 3.6462719491004677`*^9, 3.6462721350831223`*^9, 
   3.646272678669051*^9, 3.646277219750484*^9, 3.6486939524696493`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"halfrodalbedoisoscatter`muts", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
    "halfrodalbedoisoscatter`simulations"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.645065539848353*^9, 3.645065542907295*^9}, {
  3.646277022208873*^9, 3.6462770239529*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.64506554314834*^9, 3.645070161361624*^9, 
  3.6461739757283497`*^9, 3.646254687418363*^9, 3.646262947585215*^9, 
  3.6462719491576767`*^9, 3.646272135103839*^9, 3.646272678692589*^9, 
  3.646277219769197*^9, 3.648693952490026*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"halfrodalbedoisoscatter`numcollorders", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"halfrodalbedoisoscatter`simulations", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "11"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.646271938814583*^9, 3.646271939521427*^9}, {
  3.6462770267672453`*^9, 3.646277028704248*^9}}],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{3.64627194920724*^9, 3.646272135156968*^9, 
  3.646272678737818*^9, 3.646277219814145*^9, 3.648693952533187*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Halfrod Albedo", "Section",
 CellChangeTimes->{{3.619592904466242*^9, 3.6195929076724367`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MCalbedo", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"f", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.619593041708508*^9, 3.619593067156816*^9}, {
  3.619593119974382*^9, 3.619593137844071*^9}, {3.619593374253557*^9, 
  3.619593379531014*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MCalbedos", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"MCalbedo", "[", "f", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"f", ",", "halfrodalbedoisoscatter`fs"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.619593071323732*^9, 3.619593103575766*^9}, 
   3.646277268865171*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.0262874`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.0262874`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3`", ",", "0.0888128`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3`", ",", "0.0888128`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "0.17156`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "0.17156`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7`", ",", "0.291991`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7`", ",", "0.291991`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.95`", ",", "0.633904`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.95`", ",", "0.633904`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.98`", ",", "0.751703`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.98`", ",", "0.751703`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.999`", ",", "0.938793`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.999`", ",", "0.938793`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.99`", ",", "0.818082`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.99`", ",", "0.818082`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9`", ",", "0.519448`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9`", ",", "0.519448`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.61959310435157*^9, 3.619593142627248*^9, 3.6195932865037746`*^9, 
   3.619593352016692*^9, {3.61959338219311*^9, 3.619593388246698*^9}, {
   3.619593487465225*^9, 3.619593505223497*^9}, 3.619593588198498*^9, 
   3.621374422156754*^9, {3.6213744595420017`*^9, 3.621374471575078*^9}, 
   3.621374593008964*^9, 3.625760817492489*^9, 3.625761016161327*^9, 
   3.640936236796224*^9, 3.641004208677805*^9, 3.643952948258046*^9, 
   3.643953127864519*^9, 3.645070161645657*^9, 3.6461739760106688`*^9, 
   3.646254687693862*^9, 3.646262947877223*^9, 3.646272135426918*^9, 
   3.646272679046945*^9, 3.646277219935012*^9, 3.646277272333538*^9, 
   3.648693952807158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "\[Alpha]", "]"}], ";", 
  RowBox[{"vizrodalbedoiso", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"halfrodalbedoisoscatter`R", "[", "c", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", "MCalbedos", "]"}], "\[IndentingNewLine]", ",", 
     
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<R[\[Alpha]]\>\"", ","}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Single scattering albedo: \[Alpha]\>\"", ",", 
          "\"\<Total Reflectance/Albedo R(\[Alpha]): isotropically-scattering \
half rod\>\""}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.619592993305902*^9, 3.6195929999537*^9}, {
   3.6195932018649*^9, 3.61959321010837*^9}, {3.6195936692165422`*^9, 
   3.619593713091885*^9}, {3.619593781083522*^9, 3.61959378368323*^9}, {
   3.643952916676456*^9, 3.643952922132271*^9}, {3.6439529808338423`*^9, 
   3.643952982188665*^9}, 3.646277039263294*^9, {3.64627727879084*^9, 
   3.6462772815293083`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJwVk3k81IkfxtF2yLkqjHTQODrJtTp4VEpDtlyJIiFd7OZoN9WmcnRZ6Zcu
OtSg3GQqlXuc0bqZNMmMmTHGzPe7ZCg5dn5/PK/P8/r89X7+eOv5/+56WEFO
Tu60LP+/joeFrRWDHrbysh7m42A7kLfX/wvFAl+TtoRn6iyEplJnQhHFHuwn
NaUOi6lYt2Fh+kOKO+wX2TnW6lpgY4t5wf8ogTCwfbyev8weFSlMy78pEUCi
0tpfDN0RffH66WuUGPgrGhwdMQtEYARJuUpJwio1ujBzVwTmJdGe/DucBosR
/S0X/GPxusXMwWFpPi4ynJ0nlROxL5rdw7zOQHxMVInK8dv4vTB87b3RN1BZ
/4t68IEUjCR21cvLl4PmufhKUUwq6itry5s3V+Hx+i4Dryw6jkXSVLzE1Zg2
vHumsCMDlYpmMzkhdXDOcS4s7MlEBr16WsfgPRLjN8nnW+XCTrP0qVteE3w4
49RhqwKsrWMX165qRty7KHFoRyE67NyITKIF0o0KrR9TixA8/0Rbp2kbjBmf
GYreL9HI8ixVTWiH7+yJrbe3v4bbjn0cHq8D0sqB895Wb2CVet0zldqF/XYn
9qgseIe+6VsdR6O6cdmqyjLBqBR8WjNdk8mCzVt+rtSoHAX3v0S26vVAfs1N
1agXFUi/MuvqyjOfMHFddZZ/ZyWkAd6ioHdsTG6dGuBIqqBkH+daqNUL20Nz
tdKMq3FOna/MOfAFbN28SxZeNVAuWy3X7dyHkqflW+ISamHzx+4p5kQfVhcE
0eWH6vAgLZ6+4gEHnGiz9dttGuDrYfFB0YmLa4aKSbvfvcfLzsO3ysa4YF/b
ccZzWxM2NBUoCO70I1erxjO28gOWbw+S3rLnwUXjoenr8GZYWljeZAh4SA5Z
ZVGY0IIvI3830GP50ORGRX061gqxuUssxUyAWmluZVlgGwyH1ork2wWwbp08
G32gHdXUU20nLw5A015/nIzswI2OzgBXqhCff3tmHnCnE6RbxU2FaiH2mNtq
R1V04YXHom0bQgdhdNmWy9Rlgf4h+iFXQwRdas9bs78+YrzuwFmNKhHqDq4+
0bX0E/pulkvVfxtC14DmnEkeG2OtmyiXVMWwon5ZMVjai5NJ+hWRJWIscGww
WnKpD1of9NV5vhLMue/1vbeUA2tpx1e/QxK0334kXMrkYN+Sy92fAyTYlrU5
3L+eI9s99Kj7qAQ096cnR9s4WKrKWNsYJkHVjCDTXsiB4e7tTi/iJDDNEpin
LODCsvVI3IU8CXoy1Gt2hXCx9zvl+FSBBHqGKcNK4Vz8odfkfKZIgsx88yvN
p7koDjVdFFEs45Ez0AiM4WKzxnf6kSoJyi+wwpkpXNi7Xav8tUsCjSnjG/6N
XLh15kzqTkuQJXJ08FvXj/PPgiea5QioSROHHCz78TxyzbdLswikvbFcbLW5
H5NLcr4K5xEwyaZ5GDr2IyMoW8RYQCBWx6vJM6gfE+OZrF0rCdgeX2OunNqP
pzrPGOfcCbDH7hWZUXhoEge9MPEkkKVOC1PS42G8zLCA60UgjpUsFRvzsCsg
I3vnQQL9HYvT31vzMJad/nThcQJl7Ccbvu7jwdEmLTEnikDPZd5ytRQeRg4+
CWZnEfDWemyy0YgP6d3ZlodyCXx+PvQT04SPb83Hpvj5BO5FW1fsteZjBmYJ
JINArn9M8GMaH8rLmfkK5QQyhByvN8F8GPTxRozbCehmJdSZvORjn59x5Kkf
BNpcRI4eewTYfy9+y8QUAcIq5PRVbwF8W/5VjJIjodNo5/RPoACH7d4kX5lN
4pv2XOG1SAHCljuWpKiR2H9aLrGbLkB834mZyhUk3CfV/pSfFKDcLz9WdRcJ
t/sWNSalA3jbHOzU+yuJvvK9hemNA3hlu+rnPBcSxcsnXtn1DCBHN/2BsyeJ
rVENjYPjA0hmJRfF+5NgMZwSqJZCnNoTx5kfKeNJuMikFQtxsnzbs56zJGzm
ZNYnNwgRvE4+JOs8Cf+Gqe8Gn4TwVz73jRZDQknRt25kWuZNfaja1RskQrTd
p+m0Qay287GZm0FC14qhwpIMwjBfZ1b3cxI+518vmfeTCPpLWfUZ2SSM57+f
TtcRQXvS1X1HIQn5CJ11W2kizCneeSK2hMRuarJfSY4ICkZz1nuUkygMC+3V
rhNh6jZzjFol4/tzGPpcEUbDbS9V15FIchUeD9EZAsfE4v6sdhLRd1aU0W8P
gf1o2Le9k4R54l4XvddDYKnkU+ksEmpJ10MHPw7hn6GVBVt7SUhrWIYjK8R4
7z1wSoNDolt61/KWkxg1DWmbuP0kyI4jY/anxCh5tqzu4iCJHP7U5Y0tYhRr
fo53EZO4WhOiG6EgQVFssqseKdsT5p1bay1B3qin9vAwiVHbDh+HCJk3AYt6
K0ZJmadp2Y9fSZDe1kZPHCfxo2hG64ECgdQticf8JkjsCWw3feFD4EGBs4np
FIk4DZWdPzoJ3F2mJJ2ZIVEdZy14Lvv/B3J92Sc=
      "]]}}, {{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.019444444444444445`], AbsoluteThickness[1.6], 
      PointBox[{{0.1, 0.0262874}, {0.1, 0.0262874}, {0.3, 0.0888128}, {0.3, 
       0.0888128}, {0.5, 0.17156}, {0.5, 0.17156}, {0.7, 0.291991}, {0.7, 
       0.291991}, {0.95, 0.633904}, {0.95, 0.633904}, {0.98, 0.751703}, {0.98,
        0.751703}, {0.999, 0.938793}, {0.999, 0.938793}, {0.99, 0.818082}, {
       0.99, 0.818082}, {0.9, 0.519448}, {0.9, 0.519448}}]}, {}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{
     FormBox["\"R[\[Alpha]]\"", TraditionalForm], ""}, {
     FormBox["\"Single scattering albedo: \[Alpha]\"", TraditionalForm], 
     FormBox[
     "\"Total Reflectance/Albedo R(\[Alpha]): isotropically-scattering half \
rod\"", TraditionalForm]}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->500,
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{{0, 1}, {0., 0.9997143265247463}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.619593000390897*^9, 3.6195932105615263`*^9, 3.6195932892072783`*^9, {
   3.619593346508997*^9, 3.6195933520529757`*^9}, {3.6195933846735287`*^9, 
   3.619593388278432*^9}, {3.619593487505328*^9, 3.619593505268326*^9}, 
   3.6195935882315607`*^9, {3.619593674126287*^9, 3.619593713622201*^9}, 
   3.619593784399878*^9, 3.621374422212891*^9, {3.621374459669367*^9, 
   3.621374471620599*^9}, 3.621374593054254*^9, 3.6257608175409317`*^9, 
   3.625761016211163*^9, 3.6409362368430033`*^9, 3.641004208724547*^9, 
   3.643952948413391*^9, 3.64395298263938*^9, 3.6439531279153957`*^9, 
   3.645070161785976*^9, 3.646173976067939*^9, 3.646254687762287*^9, 
   3.6462629479713707`*^9, 3.646272135474256*^9, 3.646272679154695*^9, 
   3.64627722004309*^9, {3.646277272377324*^9, 3.646277281954121*^9}, 
   3.6486939530888968`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided albedo", "Subsection",
 CellChangeTimes->{{3.621359362066428*^9, 3.621359362977552*^9}, {
  3.622130497509987*^9, 3.62213050706733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "halfrodalbedoisoscatter`simulations", "]"}], 
      ">", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "Rs", ",", "ns", ",", "analytic", ",", "j", ",", 
         "numcollorders"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"halfrodalbedoisoscatter`simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numcollorders", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rs", "=", 
         RowBox[{"N", "[", 
          RowBox[{"{", 
           RowBox[{"data", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ns", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"numcollorders", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"analytic", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"halfrodalbedoisoscatter`R", "[", 
            RowBox[{"\[Alpha]", ",", "n"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "ns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "ns", "}"}], ",", 
           RowBox[{"{", "analytic", "}"}], ",", "Rs"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "\"\<n\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], "}"}],
             "}"}], ",", 
           RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "halfrodalbedoisoscatter`alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "halfrodalbedoisoscatter`muts"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.621359462271472*^9, 3.621359519826496*^9}, {
   3.621359610039978*^9, 3.621359631348999*^9}, {3.621359686715735*^9, 
   3.621359698586138*^9}, {3.643953116913168*^9, 3.643953117270402*^9}, 
   3.645068256619286*^9, {3.646254307936059*^9, 3.6462543169431477`*^9}, {
   3.646272199006176*^9, 3.6462722146570587`*^9}, {3.646272246192518*^9, 
   3.646272250744228*^9}, {3.6462770949325237`*^9, 3.646277104843841*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.98, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}}, Typeset`size$$ = {
    210., {173.134033203125, 178.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$93468$$ = 
    0, $CellContext`\[CapitalSigma]t$93469$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$93468$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$93469$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[halfrodalbedoisoscatter`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`Rs$, $CellContext`ns$, \
$CellContext`analytic$, $CellContext`j$, $CellContext`numcollorders$}, \
$CellContext`data$ = Part[
            SelectFirst[
            halfrodalbedoisoscatter`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`numcollorders$ = 
          Part[$CellContext`data$, 2, 11]; $CellContext`Rs$ = N[{
             Part[$CellContext`data$, 5]}]; $CellContext`ns$ = 
          Table[$CellContext`n, {$CellContext`n, 
             0, $CellContext`numcollorders$ - 1}]; $CellContext`analytic$ = 
          Table[
            
            halfrodalbedoisoscatter`R[$CellContext`\[Alpha]$$, \
$CellContext`n], {$CellContext`n, $CellContext`ns$}]; $CellContext`j$ = 
          Join[{$CellContext`ns$}, {$CellContext`analytic$}, \
$CellContext`Rs$]; TableForm[
           Join[{{"n", "analytic", "MC"}}, 
            Transpose[$CellContext`j$]]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{255., {230., 235.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.621359528988345*^9, {3.621359612850271*^9, 3.621359631537554*^9}, {
   3.6213596901948233`*^9, 3.621359699022088*^9}, {3.626998540141939*^9, 
   3.626998564427421*^9}, 3.626999475503785*^9, 3.627001300076396*^9, 
   3.641004106338101*^9, 3.641004224900922*^9, {3.643953112682353*^9, 
   3.6439531279900017`*^9}, 3.6439531795352573`*^9, 3.6450665828103857`*^9, 
   3.645068257141838*^9, 3.645070163635479*^9, 3.646173976851034*^9, 
   3.646254317765687*^9, 3.646254688302388*^9, 3.646262948697145*^9, 
   3.6462721358739357`*^9, 3.6462722542928762`*^9, 3.646272679407893*^9, 
   3.646277220421599*^9, 3.646277362946724*^9, 3.648693953333843*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare Deterministic and MC", "Section",
 CellChangeTimes->{{3.617428104753593*^9, 3.6174281129212646`*^9}}],

Cell[CellGroupData[{

Cell["Internal distribution", "Subsection",
 CellChangeTimes->{{3.646262885300542*^9, 3.646262887250815*^9}, 
   3.648694165319491*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"alpha", ",", "\[CapitalSigma]t"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "halfrodalbedoisoscatter`simulations", "]"}], 
      ">", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "maxx", ",", "dx", ",", "numcollorders", ",", 
         "nummoments", ",", "pointsCL", ",", "plotpointsCL", ",", "pointsCR", 
         ",", "plotpointsCR", ",", "plotpoints\[Phi]", ",", "plot\[Phi]", ",",
          "plotLL", ",", "plotLR"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"halfrodalbedoisoscatter`simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numcollorders", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nummoments", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pointsCL", " ", "=", " ", 
         RowBox[{"data", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "divide", " ", "by", " ", "\[CapitalSigma]t", " ", "to", " ", 
          "convert", " ", "collision", " ", "density", " ", "into", " ", 
          "L"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"plotpointsCL", "=", 
         RowBox[{"halfrodalbedoisoscatter`ppoints", "[", 
          RowBox[{
          "pointsCL", ",", "dx", ",", "maxx", ",", "\[CapitalSigma]t"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointsCR", " ", "=", " ", 
         RowBox[{"data", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plotpointsCR", "=", 
         RowBox[{"halfrodalbedoisoscatter`ppoints", "[", 
          RowBox[{
          "pointsCR", ",", "dx", ",", "maxx", ",", "\[CapitalSigma]t"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "divide", " ", "by", " ", "\[CapitalSigma]t", " ", "to", " ", 
          "convert", " ", "collision", " ", "density", " ", "into", " ", 
          "fluence"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"plotpoints\[Phi]", "=", 
         RowBox[{"halfrodalbedoisoscatter`ppoints", "[", 
          RowBox[{
           RowBox[{"pointsCL", "+", "pointsCR"}], ",", "dx", ",", "maxx", ",",
            "\[CapitalSigma]t"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"plot\[Phi]", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"plotpoints\[Phi]", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"halfrodalbedoisoscatter`\[Phi]", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Phi]", "[", "x", "]"}], ","}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", 
                RowBox[{
                "\"\<Semi-infinite rod, albedo problem, isotropic scattering, \
fluence \[Phi][x], \[Alpha] = \>\"", "<>", 
                 RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                 "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\
\"", "<>", 
                 RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
               "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"plotLL", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"plotpointsCL", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"halfrodalbedoisoscatter`LL", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"halfrodalbedoisoscatter`\[Phi]", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["L", "-"], "[", "x", "]"}], ","}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", 
                RowBox[{
                "\"\<Semi-infinite rod, albedo problem, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(-\)]\)[x], \[Alpha] = \>\"", "<>", 
                 RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                 "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\
\"", "<>", 
                 RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"plotLR", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"plotpointsCR", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"halfrodalbedoisoscatter`LR", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"halfrodalbedoisoscatter`\[Phi]", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["L", "+"], "[", "x", "]"}], ","}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", 
                RowBox[{
                "\"\<Semi-infinite rod, albedo problem, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x], \[Alpha] = \>\"", "<>", 
                 RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                 "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\
\"", "<>", 
                 RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"GraphicsGrid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "plot\[Phi]", "}"}], ",", 
             RowBox[{"{", "plotLL", "}"}], ",", 
             RowBox[{"{", "plotLR", "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "halfrodalbedoisoscatter`alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "halfrodalbedoisoscatter`muts"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6174281170020113`*^9, 3.61742813267981*^9}, 
   3.6174287994794273`*^9, {3.617428838302623*^9, 3.617428878809485*^9}, {
   3.6174289474455023`*^9, 3.61742896885219*^9}, {3.61742923797204*^9, 
   3.617429325246893*^9}, {3.617429373536989*^9, 3.617429375936674*^9}, {
   3.617429430039774*^9, 3.617429597670169*^9}, {3.617429724574465*^9, 
   3.6174297347942553`*^9}, {3.617429794822505*^9, 3.6174298315174522`*^9}, {
   3.6174298677304993`*^9, 3.6174298817845984`*^9}, {3.617429917431849*^9, 
   3.617429978970625*^9}, {3.617430046618482*^9, 3.6174301175661373`*^9}, {
   3.6174302274511757`*^9, 3.617430269908132*^9}, {3.617430851237011*^9, 
   3.61743094294977*^9}, {3.617431018010861*^9, 3.6174310182802477`*^9}, {
   3.617431054641918*^9, 3.6174310955544443`*^9}, {3.617431738710396*^9, 
   3.617431780737298*^9}, {3.617431916426394*^9, 3.617431938292404*^9}, {
   3.617432017592498*^9, 3.61743203121756*^9}, {3.617434253945896*^9, 
   3.617434276351254*^9}, {3.617434334762925*^9, 3.617434349959379*^9}, {
   3.617434549029696*^9, 3.617434585144499*^9}, {3.6174346161354094`*^9, 
   3.6174346244125147`*^9}, {3.617434842916192*^9, 3.617434849707287*^9}, {
   3.617847326305366*^9, 3.61784732690473*^9}, 3.617848051268721*^9, {
   3.617848167301262*^9, 3.6178481676284246`*^9}, {3.61784850895185*^9, 
   3.617848563337233*^9}, {3.617898951271072*^9, 3.617898951610284*^9}, {
   3.618035560623592*^9, 3.618035561301065*^9}, {3.6195928393795137`*^9, 
   3.619592840035911*^9}, {3.619594023021328*^9, 3.619594057454226*^9}, {
   3.619594367717161*^9, 3.619594451177827*^9}, {3.619635242437984*^9, 
   3.619635273373003*^9}, 3.6450668161459093`*^9, {3.6462541709221277`*^9, 
   3.646254197207653*^9}, {3.646254257622604*^9, 3.646254280753685*^9}, {
   3.646271995106873*^9, 3.646272029289276*^9}, {3.646272121445628*^9, 
   3.646272131625037*^9}, {3.64627705380926*^9, 3.64627709157316*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.95, $CellContext`\[CapitalSigma]t$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}}, Typeset`size$$ = {
    500., {447., 451.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Alpha]$93266$$ = 
    0, $CellContext`\[CapitalSigma]t$93267$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$93266$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$93267$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[halfrodalbedoisoscatter`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`maxx$, $CellContext`dx$, \
$CellContext`numcollorders$, $CellContext`nummoments$, \
$CellContext`pointsCL$, $CellContext`plotpointsCL$, $CellContext`pointsCR$, \
$CellContext`plotpointsCR$, $CellContext`plotpoints\[Phi]$, $CellContext`plot\
\[Phi]$, $CellContext`plotLL$, $CellContext`plotLR$}, $CellContext`data$ = 
          Part[
            SelectFirst[
            halfrodalbedoisoscatter`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`maxx$ = 
          Part[$CellContext`data$, 2, 5]; $CellContext`dx$ = 
          Part[$CellContext`data$, 2, 7]; $CellContext`numcollorders$ = 
          Part[$CellContext`data$, 2, 11]; $CellContext`nummoments$ = 
          Part[$CellContext`data$, 2, 13]; $CellContext`pointsCL$ = 
          Part[$CellContext`data$, 7]; $CellContext`plotpointsCL$ = 
          halfrodalbedoisoscatter`ppoints[$CellContext`pointsCL$, \
$CellContext`dx$, $CellContext`maxx$, $CellContext`\[CapitalSigma]t$$]; \
$CellContext`pointsCR$ = 
          Part[$CellContext`data$, 9]; $CellContext`plotpointsCR$ = 
          halfrodalbedoisoscatter`ppoints[$CellContext`pointsCR$, \
$CellContext`dx$, $CellContext`maxx$, $CellContext`\[CapitalSigma]t$$]; \
$CellContext`plotpoints\[Phi]$ = 
          halfrodalbedoisoscatter`ppoints[$CellContext`pointsCL$ + \
$CellContext`pointsCR$, $CellContext`dx$, $CellContext`maxx$, $CellContext`\
\[CapitalSigma]t$$]; $CellContext`plot\[Phi]$ = Show[
            
            ListPlot[$CellContext`plotpoints\[Phi]$, PlotRange -> All, 
             PlotStyle -> PointSize[0.01]], 
            Plot[
             
             halfrodalbedoisoscatter`\[Phi][$CellContext`x, $CellContext`\
\[Alpha]$$, $CellContext`\[CapitalSigma]t$$], {$CellContext`x, 
              0, $CellContext`maxx$}, PlotRange -> All], Frame -> True, 
            FrameLabel -> {{
               $CellContext`\[Phi][$CellContext`x], Null}, {"x", 
               StringJoin[
               "Semi-infinite rod, albedo problem, isotropic scattering, \
fluence \[Phi][x], \[Alpha] = ", 
                ToString[$CellContext`\[Alpha]$$], 
                ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
                
                ToString[$CellContext`\[CapitalSigma]t$$]]}}]; \
$CellContext`plotLL$ = Show[
            
            ListPlot[$CellContext`plotpointsCL$, PlotRange -> All, PlotStyle -> 
             PointSize[0.01]], 
            Plot[
             
             halfrodalbedoisoscatter`LL[$CellContext`x, \
$CellContext`\[Alpha]$$, $CellContext`\[CapitalSigma]t$$], {$CellContext`x, 
              0, $CellContext`maxx$}, PlotRange -> All], 
            Plot[
             
             halfrodalbedoisoscatter`\[Phi][$CellContext`x, $CellContext`\
\[Alpha]$$, $CellContext`\[CapitalSigma]t$$], {$CellContext`x, 
              0, $CellContext`maxx$}, PlotRange -> All, PlotStyle -> Dashed], 
            Frame -> True, FrameLabel -> {{
               SubMinus[$CellContext`L][$CellContext`x], Null}, {"x", 
               StringJoin[
               "Semi-infinite rod, albedo problem, isotropic scattering, \!\(\
\*SubscriptBox[\(L\), \(-\)]\)[x], \[Alpha] = ", 
                ToString[$CellContext`\[Alpha]$$], 
                ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
                ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> 
            All]; $CellContext`plotLR$ = Show[
            
            ListPlot[$CellContext`plotpointsCR$, PlotRange -> All, PlotStyle -> 
             PointSize[0.01]], 
            Plot[
             
             halfrodalbedoisoscatter`LR[$CellContext`x, \
$CellContext`\[Alpha]$$, $CellContext`\[CapitalSigma]t$$], {$CellContext`x, 
              0, $CellContext`maxx$}, PlotRange -> All], 
            Plot[
             
             halfrodalbedoisoscatter`\[Phi][$CellContext`x, $CellContext`\
\[Alpha]$$, $CellContext`\[CapitalSigma]t$$], {$CellContext`x, 
              0, $CellContext`maxx$}, PlotRange -> All, PlotStyle -> Dashed], 
            Frame -> True, FrameLabel -> {{
               SubPlus[$CellContext`L][$CellContext`x], Null}, {"x", 
               StringJoin[
               "Semi-infinite rod, albedo problem, isotropic scattering, \!\(\
\*SubscriptBox[\(L\), \(+\)]\)[x], \[Alpha] = ", 
                ToString[$CellContext`\[Alpha]$$], 
                ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
                ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> 
            All]; Show[
           
           GraphicsGrid[{{$CellContext`plot\[Phi]$}, {$CellContext`plotLL$}, \
{$CellContext`plotLR$}}], ImageSize -> 500]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{545., {503., 508.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.61742928183463*^9, 3.6174293258331547`*^9}, 
   3.617429436318664*^9, {3.61742948106245*^9, 3.6174295009489727`*^9}, {
   3.617429549372438*^9, 3.617429598132875*^9}, {3.617429727942461*^9, 
   3.617429735895954*^9}, 3.617429800033937*^9, 3.617429832097906*^9, {
   3.617429874504074*^9, 3.617429882154498*^9}, 3.617429920022324*^9, {
   3.617429950258304*^9, 3.6174299799852943`*^9}, {3.6174300589071608`*^9, 
   3.617430117980332*^9}, {3.6174302282216253`*^9, 3.6174302706886377`*^9}, {
   3.617430871226499*^9, 3.6174309434694443`*^9}, 3.617431018710215*^9, {
   3.6174310600334377`*^9, 3.617431096079486*^9}, {3.61743174071297*^9, 
   3.61743178146768*^9}, 3.617431939072937*^9, {3.617432023877068*^9, 
   3.617432031820962*^9}, {3.617434265407374*^9, 3.6174342766717987`*^9}, {
   3.617434339799399*^9, 3.6174343511449547`*^9}, {3.617434565777495*^9, 
   3.617434585410145*^9}, 3.617434850608314*^9, 3.617435047387048*^9, 
   3.617779205752945*^9, {3.617847308432588*^9, 3.6178473273725863`*^9}, 
   3.6178480525007877`*^9, 3.617848167873561*^9, {3.617848523620203*^9, 
   3.617848532847191*^9}, 3.617848563566896*^9, 3.617898951835388*^9, 
   3.618026897361377*^9, 3.618035300220717*^9, 3.618035562256834*^9, 
   3.619592841193926*^9, 3.619594067437519*^9, 3.6195942133576527`*^9, 
   3.61959436830357*^9, {3.619594405034141*^9, 3.619594451626395*^9}, 
   3.619594681819881*^9, 3.619635281279757*^9, 3.621374422271721*^9, {
   3.621374460559329*^9, 3.621374471675267*^9}, 3.6213745931334133`*^9, 
   3.625760817973997*^9, 3.625761016264855*^9, 3.640936236894485*^9, 
   3.641004208801806*^9, 3.643952948466518*^9, 3.643953128039459*^9, 
   3.645066582360589*^9, 3.645066816790968*^9, 3.645070163356307*^9, 
   3.646173976422086*^9, 3.646254199533277*^9, 3.646254282171978*^9, 
   3.6462546880659*^9, 3.6462629485021563`*^9, 3.646272135540148*^9, 
   3.6462726792068453`*^9, 3.646277220098629*^9, 3.648693953120194*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["N-th order Radiance/Angular flux", "Subsection",
 CellChangeTimes->{{3.6178474490715647`*^9, 3.617847458534074*^9}, {
  3.617898905922576*^9, 3.617898912785017*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "halfrodalbedoisoscatter`simulations", "]"}], 
      ">", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "nthL", ",", "nthR", ",", "maxx", ",", "dx", ",", 
         "numcollorders", ",", "LnR"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"halfrodalbedoisoscatter`simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numcollorders", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthL", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"13", "+", "numcollorders", "+", "1"}], ";;", 
            RowBox[{"13", "+", 
             RowBox[{"2", "numcollorders"}]}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthR", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"13", "+", 
             RowBox[{"2", " ", "numcollorders"}], "+", "2"}], ";;", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{"c", ",", "x"}], "]"}], ";", 
        RowBox[{"LnR", "=", 
         RowBox[{
          RowBox[{"SeriesCoefficient", "[", 
           RowBox[{
            RowBox[{"halfrodalbedoisoscatter`LR", "[", 
             RowBox[{"x", ",", "c", ",", "\[CapitalSigma]t"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"c", ",", "0", ",", "n"}], "}"}]}], "]"}], 
          SuperscriptBox["\[Alpha]", "n"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"halfrodalbedoisoscatter`ppoints", "[", 
             RowBox[{
              RowBox[{"nthR", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "dx", ",", "maxx",
               ",", "\[CapitalSigma]t"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{"LnR", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["L", "+"], "[", 
                RowBox[{"\"\<x|\>\"", "<>", 
                 RowBox[{"ToString", "[", "n", "]"}]}], "]"}], ","}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
               "\"\<Semi-Infinite Rod, albedo problem, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x|\>\"", "<>", 
                RowBox[{"ToString", "[", "n", "]"}], "<>", 
                "\"\<], \[Alpha] = \>\"", "<>", 
                RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \
\>\"", "<>", 
                RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "halfrodalbedoisoscatter`alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "halfrodalbedoisoscatter`muts"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "NumberQ", "[", "halfrodalbedoisoscatter`numcollorders", "]"}], ",", 
        "halfrodalbedoisoscatter`numcollorders", ",", "1"}], "]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.617848087531028*^9, 3.617848128632434*^9}, {
   3.6178483799454823`*^9, 3.6178483963910007`*^9}, {3.617848587920553*^9, 
   3.617848741866837*^9}, {3.617848861441987*^9, 3.617848980979924*^9}, {
   3.617849011268075*^9, 3.61784901338624*^9}, {3.617898922699717*^9, 
   3.6178989636088057`*^9}, 3.6178990337030487`*^9, {3.618026884521015*^9, 
   3.61802689250959*^9}, {3.6180352803157187`*^9, 3.618035289800784*^9}, {
   3.618035445763723*^9, 3.618035449259708*^9}, {3.618036397512957*^9, 
   3.618036398228166*^9}, {3.618036459241461*^9, 3.618036480538363*^9}, {
   3.619594784617628*^9, 3.61959481460251*^9}, {3.6196381857106743`*^9, 
   3.619638204748053*^9}, 3.64506987013127*^9, 3.646254340055859*^9, {
   3.64625440730513*^9, 3.646254407617051*^9}, 3.646254670105748*^9, {
   3.646272502894999*^9, 3.646272546935742*^9}, {3.646272598031747*^9, 
   3.6462726095038767`*^9}, {3.646277145177865*^9, 3.646277175575788*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 6, $CellContext`\[Alpha]$$ = 
    0.95, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {360., {107., 112.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$93556$$ = 
    0, $CellContext`\[CapitalSigma]t$93557$$ = False, $CellContext`n$93558$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 1, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$93556$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$93557$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$93558$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[halfrodalbedoisoscatter`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`nthL$, $CellContext`nthR$, \
$CellContext`maxx$, $CellContext`dx$, $CellContext`numcollorders$, \
$CellContext`LnR$}, $CellContext`data$ = Part[
            SelectFirst[
            halfrodalbedoisoscatter`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`maxx$ = 
          Part[$CellContext`data$, 2, 5]; $CellContext`dx$ = 
          Part[$CellContext`data$, 2, 7]; $CellContext`numcollorders$ = 
          Part[$CellContext`data$, 2, 11]; $CellContext`nthL$ = 
          Part[$CellContext`data$, 
            Span[
            13 + $CellContext`numcollorders$ + 1, 13 + 
             2 $CellContext`numcollorders$]]; $CellContext`nthR$ = 
          Part[$CellContext`data$, 
            Span[13 + 2 $CellContext`numcollorders$ + 2, -1]]; 
         Clear[$CellContext`c, $CellContext`x]; $CellContext`LnR$ = 
          SeriesCoefficient[
             
             halfrodalbedoisoscatter`LR[$CellContext`x, $CellContext`c, \
$CellContext`\[CapitalSigma]t$$], {$CellContext`c, 
              0, $CellContext`n$$}] $CellContext`\[Alpha]$$^$CellContext`n$$; 
         Show[
           ListPlot[
            halfrodalbedoisoscatter`ppoints[
             
             Part[$CellContext`nthR$, $CellContext`n$$ + 
              1], $CellContext`dx$, $CellContext`maxx$, $CellContext`\
\[CapitalSigma]t$$], PlotRange -> All, PlotStyle -> PointSize[0.01]], 
           
           Plot[$CellContext`LnR$, {$CellContext`x, 0, $CellContext`maxx$}, 
            PlotRange -> All], Frame -> True, FrameLabel -> {{
              SubPlus[$CellContext`L][
               StringJoin["x|", 
                ToString[$CellContext`n$$]]], Null}, {$CellContext`x, 
              StringJoin[
              "Semi-Infinite Rod, albedo problem, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x|", 
               ToString[$CellContext`n$$], "], \[Alpha] = ", 
               ToString[$CellContext`\[Alpha]$$], 
               ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
               ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> 
           All]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
         14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{405., {177., 182.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.617848123161393*^9, 3.617848129083784*^9}, 
   3.617848174888197*^9, {3.617848392787415*^9, 3.617848396653082*^9}, {
   3.617848638594962*^9, 3.6178486577788877`*^9}, {3.6178486885271482`*^9, 
   3.617848742743271*^9}, {3.617848869762526*^9, 3.617848981225264*^9}, 
   3.617849013934143*^9, {3.617898931782443*^9, 3.61789896386371*^9}, 
   3.6178990341225853`*^9, {3.618026893165267*^9, 3.618026898060422*^9}, {
   3.6180352810236397`*^9, 3.618035300786215*^9}, 3.618035450527627*^9, 
   3.618035567668068*^9, 3.618036400019929*^9, {3.6180364711769037`*^9, 
   3.618036481295393*^9}, 3.619594068369401*^9, 3.619594214219613*^9, {
   3.619594788620956*^9, 3.6195948148904943`*^9}, 3.6196382056059732`*^9, 
   3.621374422680464*^9, {3.621374461728509*^9, 3.621374471826221*^9}, 
   3.621374593338022*^9, 3.6257608183776283`*^9, 3.625761016441514*^9, 
   3.640936237089188*^9, 3.641004209023114*^9, 3.643952948772311*^9, 
   3.643953128211825*^9, 3.645066582869865*^9, 3.64506917798079*^9, 
   3.645069871050242*^9, 3.645070163856153*^9, 3.646173977550927*^9, 
   3.646254408444701*^9, {3.646254671233919*^9, 3.646254688609837*^9}, 
   3.6462629490141373`*^9, 3.646272136061755*^9, 3.646272550097081*^9, 
   3.646272623204092*^9, 3.646272679674335*^9, 3.6462772207066813`*^9, 
   3.6486939535797377`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["N-th order Fluence / scalar flux", "Subsection",
 CellChangeTimes->{{3.617898988631413*^9, 3.617898994092989*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "halfrodalbedoisoscatter`simulations", "]"}], 
      ">", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "maxx", ",", "dx", ",", "numcollorders", ",", "nthL", 
         ",", "nthR", ",", "\[Phi]n"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"halfrodalbedoisoscatter`simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numcollorders", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthL", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"13", "+", "numcollorders", "+", "1"}], ";;", 
            RowBox[{"13", "+", 
             RowBox[{"2", "numcollorders"}]}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthR", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"13", "+", 
             RowBox[{"2", " ", "numcollorders"}], "+", "2"}], ";;", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "c", "]"}], ";", 
        RowBox[{"\[Phi]n", "=", 
         RowBox[{
          RowBox[{"SeriesCoefficient", "[", 
           RowBox[{
            RowBox[{"halfrodalbedoisoscatter`\[Phi]", "[", 
             RowBox[{"x", ",", "c", ",", "\[CapitalSigma]t"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"c", ",", "0", ",", "n"}], "}"}]}], "]"}], 
          SuperscriptBox["\[Alpha]", "n"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"halfrodalbedoisoscatter`ppoints", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nthR", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", 
               RowBox[{"nthL", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}]}], ",", "dx", ",", 
              "maxx", ",", "\[CapitalSigma]t"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{"\[Phi]n", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["L", "+"], "[", 
                RowBox[{"\"\<x|\>\"", "<>", 
                 RowBox[{"ToString", "[", "n", "]"}]}], "]"}], ","}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
               "\"\<Semi-Infinite Rod, albedo problem, isotropic scattering, \
\[Phi][x|\>\"", "<>", 
                RowBox[{"ToString", "[", "n", "]"}], "<>", 
                "\"\<], \[Alpha] = \>\"", "<>", 
                RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \
\>\"", "<>", 
                RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "halfrodalbedoisoscatter`alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "halfrodalbedoisoscatter`muts"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "NumberQ", "[", "halfrodalbedoisoscatter`numcollorders", "]"}], ",", 
        "halfrodalbedoisoscatter`numcollorders", ",", "1"}], "]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.617899027974739*^9, 3.617899102058537*^9}, {
   3.6180269284074593`*^9, 3.61802695676259*^9}, {3.6180353307690983`*^9, 
   3.618035331073291*^9}, {3.6180353616180267`*^9, 3.618035387988235*^9}, {
   3.6180354327408543`*^9, 3.618035434338756*^9}, {3.6180364105604277`*^9, 
   3.618036411435473*^9}, {3.6180364749101763`*^9, 3.618036484960104*^9}, {
   3.618036515289938*^9, 3.618036541667148*^9}, 3.61803658230717*^9, {
   3.621374415363887*^9, 3.6213744160474358`*^9}, {3.621374568436318*^9, 
   3.621374587575626*^9}, {3.6213747109342413`*^9, 3.621374724211561*^9}, {
   3.621374781248908*^9, 3.621374815343933*^9}, {3.6410041951418047`*^9, 
   3.641004204457437*^9}, {3.645069985930352*^9, 3.6450700570061626`*^9}, 
   3.646254345342705*^9, {3.6462544110734043`*^9, 3.646254411352294*^9}, 
   3.6462546758012743`*^9, {3.646272564757514*^9, 3.6462725921029873`*^9}, {
   3.646272633440489*^9, 3.646272640863365*^9}, {3.6462771789836683`*^9, 
   3.646277207301758*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 4, $CellContext`\[Alpha]$$ = 
    0.95, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {360., {112., 117.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$93624$$ = 
    0, $CellContext`\[CapitalSigma]t$93625$$ = False, $CellContext`n$93626$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 1, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$93624$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$93625$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$93626$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[halfrodalbedoisoscatter`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`maxx$, $CellContext`dx$, \
$CellContext`numcollorders$, $CellContext`nthL$, $CellContext`nthR$, \
$CellContext`\[Phi]n$}, $CellContext`data$ = Part[
            SelectFirst[
            halfrodalbedoisoscatter`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`maxx$ = 
          Part[$CellContext`data$, 2, 5]; $CellContext`dx$ = 
          Part[$CellContext`data$, 2, 7]; $CellContext`numcollorders$ = 
          Part[$CellContext`data$, 2, 11]; $CellContext`nthL$ = 
          Part[$CellContext`data$, 
            Span[
            13 + $CellContext`numcollorders$ + 1, 13 + 
             2 $CellContext`numcollorders$]]; $CellContext`nthR$ = 
          Part[$CellContext`data$, 
            Span[13 + 2 $CellContext`numcollorders$ + 2, -1]]; 
         Clear[$CellContext`c]; $CellContext`\[Phi]n$ = SeriesCoefficient[
             
             halfrodalbedoisoscatter`\[Phi][$CellContext`x, $CellContext`c, \
$CellContext`\[CapitalSigma]t$$], {$CellContext`c, 
              0, $CellContext`n$$}] $CellContext`\[Alpha]$$^$CellContext`n$$; 
         Show[
           ListPlot[
            halfrodalbedoisoscatter`ppoints[
            Part[$CellContext`nthR$, $CellContext`n$$ + 1] + 
             Part[$CellContext`nthL$, $CellContext`n$$ + 
               1], $CellContext`dx$, $CellContext`maxx$, $CellContext`\
\[CapitalSigma]t$$], PlotRange -> All, PlotStyle -> PointSize[0.01]], 
           
           Plot[$CellContext`\[Phi]n$, {$CellContext`x, 
             0, $CellContext`maxx$}, PlotRange -> All], Frame -> True, 
           FrameLabel -> {{
              SubPlus[$CellContext`L][
               StringJoin["x|", 
                ToString[$CellContext`n$$]]], Null}, {$CellContext`x, 
              StringJoin[
              "Semi-Infinite Rod, albedo problem, isotropic scattering, \
\[Phi][x|", 
               ToString[$CellContext`n$$], "], \[Alpha] = ", 
               ToString[$CellContext`\[Alpha]$$], 
               ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
               ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> 
           All]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
         14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{405., {182., 187.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.617899039918179*^9, 3.617899102419764*^9}, 
   3.6180268983104553`*^9, {3.6180269344146643`*^9, 3.618026957251099*^9}, 
   3.618035301064211*^9, 3.618035331595484*^9, {3.618035362309044*^9, 
   3.618035388766169*^9}, 3.618035434897303*^9, 3.618036411887992*^9, {
   3.618036475417274*^9, 3.6180364851779413`*^9}, 3.618036558242169*^9, 
   3.618036595720891*^9, 3.619594068807925*^9, 3.619594214730229*^9, 
   3.6195948248568373`*^9, 3.621374422789831*^9, {3.621374462172583*^9, 
   3.6213744719263268`*^9}, {3.6213745700614233`*^9, 3.621374599633233*^9}, {
   3.621374712443681*^9, 3.621374724521393*^9}, {3.62137479690559*^9, 
   3.62137481153734*^9}, 3.6257608184790783`*^9, 3.62576101655676*^9, 
   3.640936237202673*^9, {3.641004200567161*^9, 3.641004209137227*^9}, 
   3.643952948964425*^9, 3.643953128321561*^9, 3.645066582952861*^9, 
   3.6450700282258663`*^9, 3.645070060176592*^9, 3.645070163994829*^9, 
   3.64617397781698*^9, 3.6462544121082277`*^9, {3.646254677177189*^9, 
   3.646254688665596*^9}, 3.646262949149982*^9, 3.646272136206377*^9, 
   3.646272679789216*^9, 3.6462772208412848`*^9, 3.648693953680644*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare moments of \[Phi]", "Subsection",
 CellChangeTimes->{{3.617779269834346*^9, 3.617779274641601*^9}}],

Cell["\<\
Divide these results, which are collision density moments, by \
\[CapitalSigma]t to produce radiance/fluence moments:\
\>", "Text",
 CellChangeTimes->{{3.617847370274527*^9, 3.617847402120873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "halfrodalbedoisoscatter`simulations", "]"}], 
      ">", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "nummoments", ",", "\[Phi]moments", ",", "ks", ",", 
         "analytic", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"halfrodalbedoisoscatter`simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nummoments", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]moments", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"{", 
            RowBox[{"data", "[", 
             RowBox[{"[", "11", "]"}], "]"}], "}"}], "\[CapitalSigma]t"], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ks", "=", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"nummoments", "-", "1"}]}], "}"}]}], "]"}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"analytic", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"halfrodalbedoisoscatter`\[Phi]m", "[", 
            RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "k"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "ks"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ks", ",", "analytic", ",", "\[Phi]moments"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "\"\<k\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], "}"}],
             "}"}], ",", 
           RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "halfrodalbedoisoscatter`alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "halfrodalbedoisoscatter`muts"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6177792806285133`*^9, 3.617779297336399*^9}, {
   3.617779343239357*^9, 3.6177794771281633`*^9}, {3.6177795098244753`*^9, 
   3.6177795247590523`*^9}, {3.617779555197104*^9, 3.617779656475761*^9}, {
   3.617779687007894*^9, 3.617779881109676*^9}, {3.617847356159178*^9, 
   3.617847361453464*^9}, {3.619594516589923*^9, 3.6195945170905647`*^9}, {
   3.619594713380765*^9, 3.619594735762917*^9}, 3.645068394199531*^9, 
   3.6462543369102907`*^9, {3.6462544012171173`*^9, 3.646254401505522*^9}, {
   3.6462722925210257`*^9, 3.646272314924221*^9}, {3.646277107722872*^9, 
   3.64627711942684*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.9, $CellContext`\[CapitalSigma]t$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}}, Typeset`size$$ = {
    181., {88.134033203125, 93.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$93497$$ = 
    0, $CellContext`\[CapitalSigma]t$93498$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$93497$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$93498$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[halfrodalbedoisoscatter`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`nummoments$, $CellContext`\
\[Phi]moments$, $CellContext`ks$, $CellContext`analytic$, $CellContext`j$}, \
$CellContext`data$ = Part[
            SelectFirst[
            halfrodalbedoisoscatter`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`nummoments$ = 
          Part[$CellContext`data$, 2, 13]; $CellContext`\[Phi]moments$ = N[{
              
              Part[$CellContext`data$, 
               11]}/$CellContext`\[CapitalSigma]t$$]; $CellContext`ks$ = {
            
            Table[$CellContext`k, {$CellContext`k, 
              0, $CellContext`nummoments$ - 1}]}; $CellContext`analytic$ = 
          Table[
            
            halfrodalbedoisoscatter`\[Phi]m[$CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`k], {$CellContext`k, \
$CellContext`ks$}]; $CellContext`j$ = 
          Join[$CellContext`ks$, $CellContext`analytic$, \
$CellContext`\[Phi]moments$]; TableForm[
           Join[{{"k", "analytic", "MC"}}, 
            Transpose[$CellContext`j$]]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{226., {145., 150.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.617779832588072*^9, {3.617779869376008*^9, 3.6177798817119627`*^9}, {
   3.6178473088352737`*^9, 3.617847330769167*^9}, 3.617847361723319*^9, 
   3.618026897603917*^9, 3.618035300457242*^9, 3.619594068174963*^9, 
   3.619594213989615*^9, 3.619594517486966*^9, {3.6195946709229193`*^9, 
   3.619594685752365*^9}, 3.6195947362190523`*^9, 3.621374422621011*^9, {
   3.621374461501079*^9, 3.621374471782186*^9}, 3.621374593290991*^9, 
   3.625760818327333*^9, {3.625761010482192*^9, 3.625761016396119*^9}, 
   3.640936237036949*^9, 3.6410042089759274`*^9, 3.643952948659853*^9, 
   3.643953128159903*^9, 3.645066582831504*^9, 3.6450683948407917`*^9, 
   3.645070163756219*^9, 3.646173977134774*^9, 3.646254402640938*^9, 
   3.6462546884830513`*^9, 3.64626294879793*^9, 3.6462721359569473`*^9, {
   3.646272320142614*^9, 3.646272326757351*^9}, 3.646272679489949*^9, 
   3.646277220531495*^9, 3.648693953417049*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided moments of \[Phi]", "Subsection",
 CellChangeTimes->{{3.646262916178207*^9, 3.646262920832403*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "halfrodalbedoisoscatter`simulations", "]"}], 
      ">", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "\[Phi]moments", ",", "ks", ",", "analytic", ",", "j", 
         ",", "nummoments"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"halfrodalbedoisoscatter`simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nummoments", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]moments", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"{", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"13", "+", "n"}], "]"}], "]"}], "}"}], 
           "\[CapitalSigma]t"], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ks", "=", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"nummoments", "-", "1"}]}], "}"}]}], "]"}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"analytic", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"N", "[", 
             RowBox[{"halfrodalbedoisoscatter`\[Phi]m", "[", 
              RowBox[{
              "\[Alpha]", ",", "\[CapitalSigma]t", ",", "k", ",", "n"}], 
              "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "ks"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ks", ",", "analytic", ",", "\[Phi]moments"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "\"\<k\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], "}"}],
             "}"}], ",", 
           RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "halfrodalbedoisoscatter`alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "halfrodalbedoisoscatter`muts"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "NumberQ", "[", "halfrodalbedoisoscatter`numcollorders", "]"}], ",", 
        "halfrodalbedoisoscatter`numcollorders", ",", "1"}], "]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.646254332711746*^9, 3.646254360739975*^9}, {
  3.6462546341534433`*^9, 3.6462546400025663`*^9}, {3.6462723555456667`*^9, 
  3.646272383775259*^9}, {3.6462771222906933`*^9, 3.6462771401613626`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 3, $CellContext`\[Alpha]$$ = 
    0.95, $CellContext`\[CapitalSigma]t$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {
    225., {88.134033203125, 93.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$93525$$ = 
    0, $CellContext`\[CapitalSigma]t$93526$$ = False, $CellContext`n$93527$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 1, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$93525$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$93526$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$93527$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[halfrodalbedoisoscatter`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`\[Phi]moments$, \
$CellContext`ks$, $CellContext`analytic$, $CellContext`j$, \
$CellContext`nummoments$}, $CellContext`data$ = Part[
            SelectFirst[
            halfrodalbedoisoscatter`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`nummoments$ = 
          Part[$CellContext`data$, 2, 13]; $CellContext`\[Phi]moments$ = N[{
              
              Part[$CellContext`data$, 
               13 + $CellContext`n$$]}/$CellContext`\[CapitalSigma]t$$]; \
$CellContext`ks$ = {
            
            Table[$CellContext`k, {$CellContext`k, 
              0, $CellContext`nummoments$ - 1}]}; $CellContext`analytic$ = 
          Table[
            Quiet[
             N[
              
              halfrodalbedoisoscatter`\[Phi]m[$CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`k, $CellContext`n$$]]], \
{$CellContext`k, $CellContext`ks$}]; $CellContext`j$ = 
          Join[$CellContext`ks$, $CellContext`analytic$, \
$CellContext`\[Phi]moments$]; TableForm[
           Join[{{"k", "analytic", "MC"}}, 
            Transpose[$CellContext`j$]]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
         14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{270., {159., 164.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6450691030559998`*^9, 3.645070163703945*^9, 3.646173976984788*^9, {
   3.646254361680525*^9, 3.6462543784379463`*^9}, 3.6462545202789383`*^9, 
   3.646254640433272*^9, 3.646254688399544*^9, 3.646262948881361*^9, 
   3.646272136013496*^9, 3.646272385426499*^9, 3.646272679573999*^9, 
   3.6462772206243753`*^9, 3.6486939535008574`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{908, 1116},
WindowMargins->{{89, Automatic}, {Automatic, 5}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 177, 2, 92, "Title"],
Cell[759, 26, 113, 1, 51, "Subtitle"],
Cell[875, 29, 540, 12, 129, "Text"],
Cell[CellGroupData[{
Cell[1440, 45, 143, 2, 64, "Section"],
Cell[1586, 49, 253, 5, 49, "Text"],
Cell[1842, 56, 122, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2001, 63, 93, 1, 64, "Section"],
Cell[2097, 66, 216, 5, 68, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2350, 76, 105, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[2480, 81, 220, 3, 44, "Subsection"],
Cell[2703, 86, 628, 17, 79, "Input"],
Cell[CellGroupData[{
Cell[3356, 107, 301, 7, 28, "Input"],
Cell[3660, 116, 1142, 31, 50, "Output"]
}, Open  ]],
Cell[4817, 150, 556, 15, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5410, 170, 209, 3, 44, "Subsection"],
Cell[5622, 175, 518, 12, 36, "Input"],
Cell[6143, 189, 686, 18, 64, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6866, 212, 97, 1, 44, "Subsection"],
Cell[6966, 215, 655, 13, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7658, 233, 111, 1, 44, "Subsection"],
Cell[7772, 236, 740, 18, 47, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8549, 259, 95, 1, 44, "Subsection"],
Cell[8647, 262, 791, 23, 63, "Input"],
Cell[9441, 287, 107, 1, 30, "Text"],
Cell[9551, 290, 2162, 63, 159, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11762, 359, 197, 3, 64, "Section"],
Cell[11962, 364, 937, 27, 46, "Input"],
Cell[12902, 393, 438, 9, 46, "Input"],
Cell[13343, 404, 1287, 33, 114, "Input"],
Cell[CellGroupData[{
Cell[14655, 441, 369, 9, 28, "Input"],
Cell[15027, 452, 464, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15528, 465, 363, 9, 28, "Input"],
Cell[15894, 476, 325, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16256, 487, 424, 10, 28, "Input"],
Cell[16683, 499, 161, 2, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16893, 507, 101, 1, 64, "Section"],
Cell[16997, 510, 891, 24, 97, "Input"],
Cell[CellGroupData[{
Cell[17913, 538, 322, 9, 28, "Input"],
Cell[18238, 549, 2010, 49, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20285, 603, 1385, 32, 148, "Input"],
Cell[21673, 637, 4967, 92, 344, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26677, 734, 156, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[26858, 740, 3628, 87, 335, "Input"],
Cell[30489, 829, 3910, 74, 482, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34460, 910, 115, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[34600, 915, 135, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[34760, 921, 12679, 265, 981, "Input"],
Cell[47442, 1188, 8907, 161, 1028, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56398, 1355, 171, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[56594, 1361, 6474, 148, 532, "Input"],
Cell[63071, 1511, 6107, 112, 376, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69227, 1629, 120, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[69372, 1634, 6634, 152, 532, "Input"],
Cell[76009, 1788, 5956, 109, 420, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82014, 1903, 113, 1, 44, "Subsection"],
Cell[82130, 1906, 207, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[82362, 1914, 3874, 91, 404, "Input"],
Cell[86239, 2007, 4316, 82, 312, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90604, 2095, 119, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[90748, 2100, 3923, 98, 438, "Input"],
Cell[94674, 2200, 4182, 83, 340, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
