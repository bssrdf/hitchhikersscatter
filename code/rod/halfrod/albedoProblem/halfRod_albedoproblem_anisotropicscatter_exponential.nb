(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     88241,       2208]
NotebookOptionsPosition[     84608,       2076]
NotebookOutlinePosition[     84966,       2092]
CellTagsIndexPosition[     84923,       2089]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Semi-Infinite Rod, Albedo Problem, Anisotropic Scattering", "Title",
 CellChangeTimes->{{3.61742787362737*^9, 3.617427885266508*^9}, {
  3.619592656668026*^9, 3.619592662680479*^9}, {3.621045944975284*^9, 
  3.621045946286415*^9}, {3.622130426295356*^9, 3.622130429558106*^9}}],

Cell[TextData[{
 "This is code to accompany the book:\n",
 StyleBox["A Hitchhiker\[CloseCurlyQuote]s Guide to Multiple Scattering\n", 
  "Subchapter"],
 StyleBox["\[Copyright] 2015", "Subsection"],
 StyleBox[" ", "Section"],
 StyleBox["Eugene d\[CloseCurlyQuote]Eon \nwww.eugenedeon.com", "Subsection"]
}], "Text",
 CellChangeTimes->{{3.6174286022468777`*^9, 3.617428710592918*^9}, 
   3.645060546597817*^9}],

Cell[CellGroupData[{

Cell["Path Setup", "Section",
 CellChangeTimes->{{3.640928920990849*^9, 3.64092892141395*^9}, {
  3.640928986491934*^9, 3.640928986905283*^9}}],

Cell["\<\
Put a file at ~/.hitchhikerpath with the path to your hitchhiker repo so that \
these worksheets can find the MC data from the C++ simulations for \
verification\
\>", "Text",
 CellChangeTimes->{{3.640928926126832*^9, 3.6409289600754013`*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"Import", "[", "\"\<~/.hitchhikerpath\>\"", "]"}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exponential Random Flight", "Subtitle",
 CellChangeTimes->{{3.619594484416584*^9, 3.6195944880949802`*^9}}],

Cell[CellGroupData[{

Cell["Notation", "Section",
 CellChangeTimes->{{3.617428538130481*^9, 3.617428538753331*^9}}],

Cell["\<\
\[Alpha] - single-scattering albedo
\[CapitalSigma]t - extinction coefficient
x - position coordinate in rod (source at x = 0)
g = \[OpenCurlyQuote]mean cosine\[CloseCurlyQuote] of scattering\
\>", "Text",
 CellChangeTimes->{{3.617428487341361*^9, 3.617428516514864*^9}, {
  3.621045977390738*^9, 3.621045984556653*^9}, {3.6267445613738937`*^9, 
  3.626744562203025*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analytic solutions", "Section",
 CellChangeTimes->{{3.617428019371695*^9, 3.6174280209794273`*^9}}],

Cell[CellGroupData[{

Cell["Half rod reflectance/albedo (R)", "Subsection",
 CellChangeTimes->{{3.621046226120826*^9, 3.62104622876783*^9}, {
  3.6450605769856167`*^9, 3.645060584375111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]", ",", "g"}], "]"}], ";", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"\[Alpha]_", ",", "g_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"\[Alpha]", 
     RowBox[{"(", 
      RowBox[{"1", "-", "g"}], ")"}]}], 
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], "-", 
     RowBox[{"\[Alpha]", " ", "g"}], " ", "+", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Alpha]", " ", "g"}]}], ")"}]}]]}], "+", 
     "2"}]]}]}]], "Input",
 CellChangeTimes->{{3.621046233602552*^9, 3.6210462382638197`*^9}, {
  3.621046269463353*^9, 3.6210462940617456`*^9}, {3.621358849677919*^9, 
  3.621358852460104*^9}, {3.626998502987534*^9, 3.6269985123431873`*^9}, {
  3.62699855191608*^9, 3.626998552170936*^9}, {3.62700049146313*^9, 
  3.62700050734369*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"\[Alpha]", ",", "g"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.621358841943308*^9, 3.621358858995325*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["g", "4"]}], ")"}], " ", "\[Alpha]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "8"], "-", 
      FractionBox[
       SuperscriptBox["g", "2"], "8"]}], ")"}], " ", 
    SuperscriptBox["\[Alpha]", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "64"], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", "g", "-", 
      SuperscriptBox["g", "2"], "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["g", "3"]}]}], ")"}], " ", 
    SuperscriptBox["\[Alpha]", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Alpha]", "]"}], "4"],
    SeriesData[$CellContext`\[Alpha], 0, {}, 1, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Alpha], 0, {
   Rational[1, 4] + Rational[-1, 4] $CellContext`g, Rational[1, 8] + 
    Rational[-1, 8] $CellContext`g^2, 
    Rational[1, 64] (5 + $CellContext`g - $CellContext`g^2 - 
     5 $CellContext`g^3)}, 1, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.621358859468233*^9, 3.621359345877529*^9, {3.6269985193193493`*^9, 
   3.626998562429688*^9}, 3.6269994731510267`*^9, 3.6270005126693993`*^9, 
   3.627001297482883*^9, 3.6270018001990747`*^9, 3.641004105710767*^9, 
   3.641004224379239*^9, 3.64395381566402*^9, 3.645070239397645*^9, 
   3.6460132546049337`*^9, 3.6462640181907177`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"\[Alpha]_", ",", "g_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "n"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"A", ",", "g"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "0", ",", "n"}], "}"}]}], "]"}], "/.", 
     RowBox[{"A", "\[Rule]", "\[Alpha]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6213588768625402`*^9, 3.621358910840705*^9}, {
  3.621359183763137*^9, 3.621359201660227*^9}, {3.621359242481744*^9, 
  3.621359247856349*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[OpenCurlyQuote]Radiance\[CloseCurlyQuote]", "Subsection",
 CellChangeTimes->{{3.621138567472877*^9, 3.62113857255315*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LR", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "g_"}], 
   "]"}], ":=", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", " ", "\[CapitalSigma]t"}], " ", "x", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Alpha]", " ", "g"}]}], " ", ")"}]}]]}]], " "}]], "Input",
 CellChangeTimes->{{3.621138581480899*^9, 3.6211385844404373`*^9}, {
  3.6211386192609053`*^9, 3.621138642332806*^9}, {3.626998631916769*^9, 
  3.6269986404999037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LL", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "g_"}], 
   "]"}], ":=", 
  FractionBox[
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"1", "-", "g"}], ")"}], 
    SuperscriptBox["E", 
     RowBox[{
      RowBox[{"-", "\[CapitalSigma]t"}], " ", "x", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Alpha]", " ", "g"}]}], " ", ")"}]}]]}]]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        SqrtBox[
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"\[Alpha]", " ", "g", " "}]}], 
          RowBox[{"1", "-", "\[Alpha]"}]]]}], "+", "g", "+", "1"}], ")"}]}], 
    "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"\[Alpha]", " ", "g", " "}]}], 
         RowBox[{"1", "-", "\[Alpha]"}]]], "+", "1"}], ")"}]}]}]]}]], "Input",\

 CellChangeTimes->{{3.621139077005056*^9, 3.62113915511635*^9}, 
   3.626998650098126*^9, {3.626999416242732*^9, 3.626999440497489*^9}, {
   3.6270012675318604`*^9, 3.6270012850232067`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fluence", "Subsection",
 CellChangeTimes->{{3.621358078506432*^9, 3.621358079360614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "g_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"LR", "[", 
    RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}], "]"}], 
   "+", 
   RowBox[{"LL", "[", 
    RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.621139159174862*^9, 3.6211391901775846`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided fluence", "Subsection",
 CellChangeTimes->{{3.621358084801984*^9, 3.6213580888724403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{
   "x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "g_", ",", "n_"}], 
   "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "n"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "A", ",", "\[CapitalSigma]t", ",", "g"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "0", ",", "n"}], "}"}]}], "]"}], "/.", 
     RowBox[{"A", "\[Rule]", "\[Alpha]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.621359852120468*^9, 3.621359891634035*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["moments", "Subsection",
 CellChangeTimes->{{3.621358091872182*^9, 3.621358092464017*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]m", "[", 
   RowBox[{"\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "k_", ",", "g_"}], 
   "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[CapitalSigma]t", 
    RowBox[{
     RowBox[{"-", "1"}], "-", "k"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"g", " ", "\[Alpha]"}]}], ")"}]}], ")"}], 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "k"}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", "\[Alpha]"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SqrtBox[
           FractionBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"g", " ", "\[Alpha]"}]}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]"}]]]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "g", "+", 
          RowBox[{"2", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"g", " ", "\[Alpha]"}]}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]"}]]]}]}], ")"}]}]}]]}], 
    ")"}], " ", 
   RowBox[{"Gamma", "[", 
    RowBox[{"1", "+", "k"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.643953959484824*^9, 3.643953968446703*^9}, {
  3.6462650739761887`*^9, 3.646265074306006*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]m", "[", 
   RowBox[{
   "\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "k_", ",", "g_", ",", "n_"}], 
   "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "n"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"\[Phi]m", "[", 
        RowBox[{"A", ",", "\[CapitalSigma]t", ",", "k", ",", "g"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "0", ",", "n"}], "}"}]}], "]"}], "/.", 
     RowBox[{"A", "\[Rule]", "\[Alpha]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.646265228622301*^9, 3.646265236135079*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["load MC data", "Section",
 CellChangeTimes->{{3.617427964847665*^9, 3.617427965662361*^9}, {
  3.6174280073412037`*^9, 3.617428007556081*^9}, {3.640936210100869*^9, 
  3.640936211771452*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\<code/rod/halfrod/albedoProblem/data/halfrod_albedoproblem_\
anisotropicscatter_exp*\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.617431703558316*^9, 3.61743173077596*^9}, {
   3.61959282254521*^9, 3.6195928356726227`*^9}, {3.6409361975771008`*^9, 
   3.640936201348721*^9}, 3.645065566454424*^9, 3.645070366704479*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"index", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"x", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalSigma]t", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "11"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"g", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "g", ",", "data"}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simulations", "=", 
   RowBox[{"index", "/@", "fs"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.645065231793377*^9, 3.645065296029221*^9}, {
   3.6450653296918097`*^9, 3.6450653865106487`*^9}, 3.6450654361720257`*^9, {
   3.645070398534631*^9, 3.64507041381848*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphas", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "simulations"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.645065448960425*^9, 3.6450654746981783`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.1`", ",", "0.3`", ",", "0.5`", ",", "0.7`", ",", "0.9`", ",", "0.95`", 
   ",", "0.98`", ",", "0.99`", ",", "0.999`"}], "}"}]], "Output",
 CellChangeTimes->{{3.6450654647633867`*^9, 3.645065474997116*^9}, 
   3.645070161322473*^9, {3.645070416815612*^9, 3.6450704207907753`*^9}, 
   3.6460132741736317`*^9, 3.646018358260395*^9, 3.6462641793277407`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"muts", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "simulations"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.645065539848353*^9, 3.645065542907295*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.64506554314834*^9, 3.645070161361624*^9, 
  3.645070420839724*^9, 3.64601327419059*^9, 3.6460183582793713`*^9, 
  3.646264179347617*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gs", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "simulations"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.645070444469393*^9, 3.64507044680763*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.9`"}], ",", 
   RowBox[{"-", "0.7`"}], ",", 
   RowBox[{"-", "0.5`"}], ",", 
   RowBox[{"-", "0.3`"}], ",", 
   RowBox[{"-", "0.1`"}], ",", "0.1`", ",", "0.3`", ",", "0.5`", ",", "0.7`", 
   ",", "0.9`"}], "}"}]], "Output",
 CellChangeTimes->{3.645070446972755*^9, 3.646013274232476*^9, 
  3.64601835832266*^9, 3.646264179398129*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Monte Carlo vs Analytic", "Section",
 CellChangeTimes->{{3.621046209274397*^9, 3.6210462106407747`*^9}, {
   3.621138666918145*^9, 3.621138671292919*^9}, 3.646265363468116*^9, {
   3.64626540223999*^9, 3.6462654053113937`*^9}}],

Cell[CellGroupData[{

Cell["Albedo (reflectance) variation in g", "Subsection",
 CellChangeTimes->{{3.6462653659223633`*^9, 3.646265399880106*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fsgvariation", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\<code/rod/halfrod/albedoProblem/data/halfrod_albedoproblem_\
anisotropicscatter_exp_c0.95_mut1.0_*\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.617431703558316*^9, 3.61743173077596*^9}, {
   3.61959282254521*^9, 3.6195928356726227`*^9}, {3.62104613516708*^9, 
   3.62104616388367*^9}, 3.621046306359949*^9, {3.6410039937136908`*^9, 
   3.641004005134576*^9}, {3.6462640257443457`*^9, 3.646264025935555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RMC", "[", "filename_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"filename", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.62104637413619*^9, 3.621046404127735*^9}, {
  3.62104666533099*^9, 3.621046695040614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gvariationpoints", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RMC", "[", "f", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", "fsgvariation"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.621046678913002*^9, 3.62104670132049*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "g", "]"}], ";", 
  RowBox[{"vizgvariation", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"0.95", ",", "g"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", 
         RowBox[{"-", "0.9"}], ",", "0.9"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"gvariationpoints", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Medium", "]"}], ",", "Black"}], 
         "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<R\>\"", "[", 
           RowBox[{"0.95", ",", "g"}], "]"}], ","}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<g\>\"", ",", 
          "\"\<Total Reflectance/Albedo R(\[Alpha],g): \
anisotropically-scattering half rod\>\""}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.621046703840535*^9, 3.6210467328708487`*^9}, {
  3.6210468046432047`*^9, 3.621046807899597*^9}, {3.621046864105681*^9, 
  3.621046916677774*^9}, {3.621046960204524*^9, 3.6210470134885817`*^9}, {
  3.627001869303133*^9, 3.627001979517416*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJwt1H081HcAB/Ar1VYeSqnU5CShBywnWbSPaErSw7XJRDXFstoMNXq1KSI5
8tjYVmmNHkS0Wapz9S0PhSn37HLhnLvfdff7rVHkIWX2eu2Pz+vzev/3+euz
MDyaGzGRxWLtGs9/fW2yxZ2WFoa4DSZ+fHiYQlVX+ohfI0N8FrP3O41bcGfM
80EdQ7ZcvM7TDlF4/DV97yafIaUNOfzPxt0rq60vusqQoGObG1YOUnC/HCP8
NoUhZxrPpfb3U6j1a9VZeDHkZ3/r0oO9FJRpvDlhZTS5mJ61ar2Ogj3T/veZ
GAOJ/3KMayKhwFR8+KZwk56cjeFfukQomI46fBbi9Jy8fS56wS6nsGHZsGP9
AEUs5giMQwsovLvd6jos1hJW9lVVfBKFJ47Hq2WFGnJwpDh46VcUhm3FJ2PC
e8hNWbLTj1wKF44uOa1YqyZ/c6Y5M54UdleHmOre7yaVwWcHC2wpuF6wTUtq
6iKHjvrpXKZRCKXEmVWZHWRJUfKHqX1a8PvcT7qxlWSj+sSXKpkWZvxLdIBS
QdJm5F5bWaNFgV/juj8i5YTrZxQScF4Lic5pVeFbCXncueBYW6IWU/yKfpx5
T0QU5o68qC+0eCZMab1z9gk5lJFktclbi8JsdcBRs2aSM+AVscJGixr5lcp2
dgMxORQ+z2hUA//1rz5ZteE+WTeJ3zoi1yB179X9SWm3iL0o6+2bPzTIz4t1
/DW+jGwzJTk+PA3yMqSk+/M8UiNoiUoN16Cidtqa/BO5SFRZ6SQfaSClgo6Z
uJejb21p+xljDbb56MceO9+C1ZzkVv/OHrixyofKk+/jbp8Apdd6IF3ZcW8g
qAHNdpzwZYd7kN43VG6uaELeb99w0rx7ILO7XpXNf4Kqd/awm9SDD/5ZHNNb
IkJnY4IipFGNuatco+d3SyBw2LmOw1Ojk887MhAoh2naHLMdPmrcSFLMXZ2r
gDf9aH/pSDcCU2JrXSYrYUiwMfK90o2BpgkTsrd0gHPBznf79m7oRgIvR2d1
4dqpmQ1ZIyqIOa/KWGMqdNexF/TlqlBtzN/8bqEaa293zfrYQYVjE67EfxrW
A2MjQd+7LV14cfDldjpPgykzshfar+6E+ojHSHWVFh67+62aLTsgKCmxVzIU
Jkbln7tUrcQHMcYL3Myf4z3xvAd8r3awq4QPH7vo0V61gtwc3120Jye71E2P
74ccN1LpClibbQ1O/UgPO0vVD+bJ445q1Xv56hFRX9mwI1YBK/YTk/IgPVpU
PuxirgLzM/7i8n7QQ/mV9VyXmQpY7H3Y6feXHkce0XGGzDZMnSV4TSINKOi1
fcCJlsOsrDhvwwEDfprean4oUg4L3wxnUbQBnGX0wPUwOWziQiLVCQZsrlcH
mW2Sw10yJJuUYYAuLOT0cUc59uWvvOlfacDZ4BTbRSoZ7s+qjJMMGvB+wWwj
m40yPCwrmB46asDEGIFXkrcMLb6JZRoWjVyvRmW7uwxtcYE9A1Np7FEtZ8cv
kuGFhOZaWtHQx9rzuKNSWJ1xdA3zprHUtnBBRrkUCRa/9VKnaPBlAb9UTpFi
zbO6tNenaWzZeWda04gEE0u01lPyaWw9xZ/X9kKCDM6SwMXnaTi8PtUglEtQ
xL1Ruvd3GizWbEePyxLU59wLVz2l0TbmMb3BRwJzU6X06VIGTzuaqz1jxZBL
Rw/oXRhEJmnWk31i/HLO2mjYjUFT4Zoitx1i2C0PX2EJBosba5z7PcXwCNCf
DtrOILPmYXvdJDF2pQ/6SY4yGDWvX52ZL8KibfM61ccZyLOy2qxTRXhu6Xn4
ZSqD4I7iiIvfiRBzNbHYPIcBf5FWevhzEVIeTWZtLWGgOx8eEWwtgn+2Q+Hu
Ugb2Rb/2R04XwWyHv3N0BYM3d/lR+1giFFKZoVm3GdQMbkxYphYitKLi1fm7
DGaZzG/uFwth852Qd72WQVhHXGx5nRDaNS8X3n3EoD8pdhP3TyH+/3PInYgr
VSLEv6MLICY=
      "]]}}, {{}, {{}, 
     {GrayLevel[0], PointSize[Medium], AbsoluteThickness[1.6], 
      PointBox[{{-0.1, 0.648215}, {0.1, 0.619074}, {-0.3, 0.670517}, {0.3, 
       0.581589}, {-0.5, 0.688995}, {0.5, 0.527689}, {-0.7, 0.704815}, {0.7, 
       0.442476}, {-0.9, 0.718383}, {0.9, 0.259878}}]}, {}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.24},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{
     FormBox[
      RowBox[{"\"R\"", "(", 
        RowBox[{"0.95`", ",", "g"}], ")"}], TraditionalForm], ""}, {
     FormBox["\"g\"", TraditionalForm], 
     FormBox[
     "\"Total Reflectance/Albedo R(\[Alpha],g): anisotropically-scattering \
half rod\"", TraditionalForm]}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{{-0.9, 0.9}, {0.2600646491598274, 0.7179514141678056}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.621046719191348*^9, 3.621046733363744*^9}, {
   3.621046808302055*^9, 3.6210468128033943`*^9}, {3.621046877799305*^9, 
   3.621047013731854*^9}, 3.6211392286332006`*^9, 3.621359346205553*^9, {
   3.626998538109331*^9, 3.6269985627697563`*^9}, 3.626999473559291*^9, 
   3.6270012978707848`*^9, 3.627001806754101*^9, {3.627001872222986*^9, 
   3.627001876056012*^9}, {3.627001921388216*^9, 3.627001979890202*^9}, 
   3.64100410606644*^9, 3.641004224651071*^9, 3.6450702485249968`*^9, 
   3.6460132606421843`*^9, {3.646264021287964*^9, 3.64626403021426*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided albedo", "Subsection",
 CellChangeTimes->{{3.621359362066428*^9, 3.621359362977552*^9}, {
  3.622130497509987*^9, 3.62213050706733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"SelectFirst", "[", 
         RowBox[{"simulations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "g"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"{", 
         RowBox[{"data", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ns", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"n", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", 
           RowBox[{"numcollorders", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"analytic", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"\[Alpha]", ",", "g", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "ns"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"j", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "ns", "}"}], ",", 
         RowBox[{"{", "analytic", "}"}], ",", "Rs"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], 
           "}"}], "}"}], ",", 
         RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], "\[IndentingNewLine]",
        "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "gs"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.646264562294825*^9, 3.646264581499798*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = 0.5, $CellContext`\[Alpha]$$ = 
    0.9, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`g$$], {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5, 
      0.7, 0.9}}}, Typeset`size$$ = {
    218., {173.134033203125, 178.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4578279$$ = 
    0, $CellContext`\[CapitalSigma]t$4578280$$ = 
    False, $CellContext`g$4578281$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = -0.9, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4578279$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4578280$$, False], 
        Hold[$CellContext`g$$, $CellContext`g$4578281$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, $CellContext`data = Part[
           
           SelectFirst[$CellContext`simulations, And[
            Part[#, 1] == $CellContext`\[Alpha]$$, 
             Part[#, 2] == $CellContext`\[CapitalSigma]t$$, 
             Part[#, 3] == $CellContext`g$$]& ], 4]; $CellContext`Rs = N[{
            Part[$CellContext`data, 5]}]; $CellContext`ns = 
         Table[$CellContext`n, {$CellContext`n, 0, $CellContext`numcollorders - 
            1}]; $CellContext`analytic = Table[
           $CellContext`R[$CellContext`\[Alpha]$$, $CellContext`g$$, \
$CellContext`n], {$CellContext`n, $CellContext`ns}]; $CellContext`j = 
         Join[{$CellContext`ns}, {$CellContext`analytic}, $CellContext`Rs]; 
        TableForm[
          Join[{{"n", "analytic", "MC"}}, 
           Transpose[$CellContext`j]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`g$$, {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5,
          0.7, 0.9}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{263., {244., 249.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.646264581878374*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Internal distributions", "Subsection",
 CellChangeTimes->{{3.62135928661305*^9, 3.621359289020988*^9}, 
   3.646265426272666*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"alpha", ",", "\[CapitalSigma]t", ",", "g"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"SelectFirst", "[", 
         RowBox[{"simulations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "g"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxx", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"dx", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"numcollorders", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nummoments", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"densmom", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", "11", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pointsCL", " ", "=", " ", 
       RowBox[{"data", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "divide", " ", "by", " ", "\[CapitalSigma]t", " ", "to", " ", 
        "convert", " ", "collision", " ", "density", " ", "into", " ", "L"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"plotpointsCL", "=", 
       RowBox[{"ppoints", "[", 
        RowBox[{"pointsCL", ",", "dx", ",", "maxx", ",", "\[CapitalSigma]t"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pointsCR", " ", "=", " ", 
       RowBox[{"data", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotpointsCR", "=", 
       RowBox[{"ppoints", "[", 
        RowBox[{"pointsCR", ",", "dx", ",", "maxx", ",", "\[CapitalSigma]t"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "divide", " ", "by", " ", "\[CapitalSigma]t", " ", "to", " ", 
        "convert", " ", "collision", " ", "density", " ", "into", " ", 
        "fluence"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"plotpoints\[Phi]", "=", 
       RowBox[{"ppoints", "[", 
        RowBox[{
         RowBox[{"pointsCL", "+", "pointsCR"}], ",", "dx", ",", "maxx", ",", 
         "\[CapitalSigma]t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plot\[Phi]", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"plotpoints\[Phi]", ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "x", "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
              "\"\<Semi-infinite rod, albedo problem, anisotropic scattering, \
fluence \[Phi][x], \[Alpha] = \>\"", "<>", 
               RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
               "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \
\>\"", "<>", 
               RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}], "<>", 
               "\"\<, g = \>\"", "<>", 
               RowBox[{"ToString", "[", "g", "]"}]}]}], "}"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plotLL", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"plotpointsCL", ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"LL", "[", 
            RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["L", "-"], "[", "x", "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
              "\"\<Semi-infinite rod, albedo problem, anisotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(-\)]\)[x], \[Alpha] = \>\"", "<>", 
               RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
               "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \
\>\"", "<>", 
               RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}], "<>", 
               "\"\<, g = \>\"", "<>", 
               RowBox[{"ToString", "[", "g", "]"}]}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotLR", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"plotpointsCR", ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"LR", "[", 
            RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g"}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["L", "+"], "[", "x", "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
              "\"\<Semi-infinite rod, albedo problem, anisotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x], \[Alpha] = \>\"", "<>", 
               RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
               "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \
\>\"", "<>", 
               RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}], "<>", 
               "\"\<, g = \>\"", "<>", 
               RowBox[{"ToString", "[", "g", "]"}]}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"GraphicsGrid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "plot\[Phi]", "}"}], ",", 
           RowBox[{"{", "plotLL", "}"}], ",", 
           RowBox[{"{", "plotLR", "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "gs"}], "}"}]}], "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.6174281170020113`*^9, 3.61742813267981*^9}, 
   3.6174287994794273`*^9, {3.617428838302623*^9, 3.617428878809485*^9}, {
   3.6174289474455023`*^9, 3.61742896885219*^9}, {3.61742923797204*^9, 
   3.617429325246893*^9}, {3.617429373536989*^9, 3.617429375936674*^9}, {
   3.617429430039774*^9, 3.617429597670169*^9}, {3.617429724574465*^9, 
   3.6174297347942553`*^9}, {3.617429794822505*^9, 3.6174298315174522`*^9}, {
   3.6174298677304993`*^9, 3.6174298817845984`*^9}, {3.617429917431849*^9, 
   3.617429978970625*^9}, {3.617430046618482*^9, 3.6174301175661373`*^9}, {
   3.6174302274511757`*^9, 3.617430269908132*^9}, {3.617430851237011*^9, 
   3.61743094294977*^9}, {3.617431018010861*^9, 3.6174310182802477`*^9}, {
   3.617431054641918*^9, 3.6174310955544443`*^9}, {3.617431738710396*^9, 
   3.617431780737298*^9}, {3.617431916426394*^9, 3.617431938292404*^9}, {
   3.617432017592498*^9, 3.61743203121756*^9}, {3.617434253945896*^9, 
   3.617434276351254*^9}, {3.617434334762925*^9, 3.617434349959379*^9}, {
   3.617434549029696*^9, 3.617434585144499*^9}, {3.6174346161354094`*^9, 
   3.6174346244125147`*^9}, {3.617434842916192*^9, 3.617434849707287*^9}, {
   3.617847326305366*^9, 3.61784732690473*^9}, 3.617848051268721*^9, {
   3.617848167301262*^9, 3.6178481676284246`*^9}, {3.61784850895185*^9, 
   3.617848563337233*^9}, {3.617898951271072*^9, 3.617898951610284*^9}, {
   3.618035560623592*^9, 3.618035561301065*^9}, {3.6195928393795137`*^9, 
   3.619592840035911*^9}, {3.619594023021328*^9, 3.619594057454226*^9}, {
   3.619594367717161*^9, 3.619594451177827*^9}, {3.619635242437984*^9, 
   3.619635273373003*^9}, 3.6450668161459093`*^9, {3.6462541709221277`*^9, 
   3.646254197207653*^9}, {3.646254257622604*^9, 3.646254280753685*^9}, {
   3.64626421451793*^9, 3.646264270826282*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = 0.5, $CellContext`\[Alpha]$$ = 
    0.95, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`g$$], {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5, 
      0.7, 0.9}}}, Typeset`size$$ = {500., {447., 451.}}, Typeset`update$$ = 
    0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4576147$$ = 
    0, $CellContext`\[CapitalSigma]t$4576148$$ = 
    False, $CellContext`g$4576149$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = -0.9, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4576147$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4576148$$, False], 
        Hold[$CellContext`g$$, $CellContext`g$4576149$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, $CellContext`data = Part[
           
           SelectFirst[$CellContext`simulations, And[
            Part[#, 1] == $CellContext`\[Alpha]$$, 
             Part[#, 2] == $CellContext`\[CapitalSigma]t$$, 
             Part[#, 3] == $CellContext`g$$]& ], 4]; $CellContext`maxx = 
         Part[$CellContext`data, 2, 5]; $CellContext`dx = 
         Part[$CellContext`data, 2, 7]; $CellContext`numcollorders = 
         Part[$CellContext`data, 2, 11]; $CellContext`nummoments = 
         Part[$CellContext`data, 2, 13]; $CellContext`densmom = 
         Part[$CellContext`data, 11]; $CellContext`pointsCL = 
         Part[$CellContext`data, 
           7]; $CellContext`plotpointsCL = \
$CellContext`ppoints[$CellContext`pointsCL, $CellContext`dx, \
$CellContext`maxx, $CellContext`\[CapitalSigma]t$$]; $CellContext`pointsCR = 
         Part[$CellContext`data, 
           9]; $CellContext`plotpointsCR = \
$CellContext`ppoints[$CellContext`pointsCR, $CellContext`dx, \
$CellContext`maxx, $CellContext`\[CapitalSigma]t$$]; $CellContext`plotpoints\
\[Phi] = $CellContext`ppoints[$CellContext`pointsCL + $CellContext`pointsCR, \
$CellContext`dx, $CellContext`maxx, $CellContext`\[CapitalSigma]t$$]; \
$CellContext`plot\[Phi] = Show[
           
           ListPlot[$CellContext`plotpoints\[Phi], PlotRange -> All, 
            PlotStyle -> PointSize[0.01]], 
           Plot[
            $CellContext`\[Phi][$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`g$$], {$CellContext`x, 
             0, $CellContext`maxx}, PlotRange -> All], Frame -> True, 
           FrameLabel -> {{
              $CellContext`\[Phi][$CellContext`x], Null}, {$CellContext`x, 
              StringJoin[
              "Semi-infinite rod, albedo problem, anisotropic scattering, \
fluence \[Phi][x], \[Alpha] = ", 
               ToString[$CellContext`\[Alpha]$$], 
               ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
               ToString[$CellContext`\[CapitalSigma]t$$], ", g = ", 
               ToString[$CellContext`g$$]]}}]; $CellContext`plotLL = Show[
           
           ListPlot[$CellContext`plotpointsCL, PlotRange -> All, PlotStyle -> 
            PointSize[0.01]], 
           Plot[
            $CellContext`LL[$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`g$$], {$CellContext`x, 
             0, $CellContext`maxx}, PlotRange -> All], 
           Plot[
            $CellContext`\[Phi][$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`g$$], {$CellContext`x, 
             0, $CellContext`maxx}, PlotRange -> All, PlotStyle -> Dashed], 
           Frame -> True, FrameLabel -> {{
              SubMinus[$CellContext`L][$CellContext`x], 
              Null}, {$CellContext`x, 
              StringJoin[
              "Semi-infinite rod, albedo problem, anisotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(-\)]\)[x], \[Alpha] = ", 
               ToString[$CellContext`\[Alpha]$$], 
               ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
               ToString[$CellContext`\[CapitalSigma]t$$], ", g = ", 
               ToString[$CellContext`g$$]]}}, PlotRange -> 
           All]; $CellContext`plotLR = Show[
           
           ListPlot[$CellContext`plotpointsCR, PlotRange -> All, PlotStyle -> 
            PointSize[0.01]], 
           Plot[
            $CellContext`LR[$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`g$$], {$CellContext`x, 
             0, $CellContext`maxx}, PlotRange -> All], 
           Plot[
            $CellContext`\[Phi][$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`g$$], {$CellContext`x, 
             0, $CellContext`maxx}, PlotRange -> All, PlotStyle -> Dashed], 
           Frame -> True, FrameLabel -> {{
              SubPlus[$CellContext`L][$CellContext`x], Null}, {$CellContext`x, 
              StringJoin[
              "Semi-infinite rod, albedo problem, anisotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x], \[Alpha] = ", 
               ToString[$CellContext`\[Alpha]$$], 
               ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
               ToString[$CellContext`\[CapitalSigma]t$$], ", g = ", 
               ToString[$CellContext`g$$]]}}, PlotRange -> All]; Show[
          
          GraphicsGrid[{{$CellContext`plot\[Phi]}, {$CellContext`plotLL}, \
{$CellContext`plotLR}}], ImageSize -> 500], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`g$$, {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5,
          0.7, 0.9}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{545., {516., 521.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.64626427519319*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided radiance/angular flux", "Subsection",
 CellChangeTimes->{{3.621360053304756*^9, 3.621360060303028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"SelectFirst", "[", 
         RowBox[{"simulations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "g"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nthL", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"13", "+", "numcollorders", "+", "1"}], ";;", 
          RowBox[{"13", "+", 
           RowBox[{"2", "numcollorders"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nthR", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"13", "+", 
           RowBox[{"2", " ", "numcollorders"}], "+", "2"}], ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "c", "]"}], ";", 
      RowBox[{"LnR", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{
           RowBox[{"LR", "[", 
            RowBox[{"x", ",", "c", ",", "\[CapitalSigma]t", ",", "g"}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "0", ",", "n"}], "}"}]}], "]"}], 
         SuperscriptBox["\[Alpha]", "n"]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"ppoints", "[", 
           RowBox[{
            RowBox[{"nthR", "[", 
             RowBox[{"[", 
              RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "dx", ",", "maxx", 
            ",", "\[CapitalSigma]t"}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{"LnR", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["L", "+"], "[", 
              RowBox[{"\"\<x|\>\"", "<>", 
               RowBox[{"ToString", "[", "n", "]"}]}], "]"}], ","}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{
             "\"\<Semi-Infinite Rod, albedo problem, anisotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x|\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}], "<>", 
              "\"\<], \[Alpha] = \>\"", "<>", 
              RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
              "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\"",
               "<>", 
              RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}], "<>", 
              "\"\<, g = \>\"", "<>", 
              RowBox[{"ToString", "[", "g", "]"}]}]}], "}"}]}], "}"}]}], ",", 
        
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "gs"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "numcollorders", "]"}], ",", "numcollorders", 
        ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.646265482096263*^9, 3.646265518506816*^9}, {
  3.646265550384657*^9, 3.646265558782164*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = -0.9, $CellContext`n$$ = 
    1, $CellContext`\[Alpha]$$ = 0.1, $CellContext`\[CapitalSigma]t$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`g$$], {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5, 
      0.7, 0.9}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {500., {157., 162.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4771596$$ = 
    0, $CellContext`\[CapitalSigma]t$4771597$$ = 
    False, $CellContext`g$4771598$$ = 0, $CellContext`n$4771599$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = -0.9, $CellContext`n$$ = 
        1, $CellContext`\[Alpha]$$ = 0.1, $CellContext`\[CapitalSigma]t$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4771596$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4771597$$, False], 
        Hold[$CellContext`g$$, $CellContext`g$4771598$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$4771599$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, $CellContext`data = Part[
           
           SelectFirst[$CellContext`simulations, And[
            Part[#, 1] == $CellContext`\[Alpha]$$, 
             Part[#, 2] == $CellContext`\[CapitalSigma]t$$, 
             Part[#, 3] == $CellContext`g$$]& ], 4]; $CellContext`nthL = 
         Part[$CellContext`data, 
           Span[
           13 + $CellContext`numcollorders + 1, 13 + 
            2 $CellContext`numcollorders]]; $CellContext`nthR = 
         Part[$CellContext`data, 
           Span[13 + 2 $CellContext`numcollorders + 2, -1]]; 
        Clear[$CellContext`c]; $CellContext`LnR = 
         FullSimplify[SeriesCoefficient[
             $CellContext`LR[$CellContext`x, $CellContext`c, $CellContext`\
\[CapitalSigma]t$$, $CellContext`g$$], {$CellContext`c, 
              0, $CellContext`n$$}] $CellContext`\[Alpha]$$^$CellContext`n$$]; 
        Show[
          ListPlot[
           $CellContext`ppoints[
            
            Part[$CellContext`nthR, $CellContext`n$$ + 
             1], $CellContext`dx, $CellContext`maxx, $CellContext`\
\[CapitalSigma]t$$], PlotRange -> All, PlotStyle -> PointSize[0.01]], 
          
          Plot[$CellContext`LnR, {$CellContext`x, 0, $CellContext`maxx}, 
           PlotRange -> All], Frame -> True, FrameLabel -> {{
             SubPlus[$CellContext`L][
              StringJoin["x|", 
               ToString[$CellContext`n$$]]], Null}, {$CellContext`x, 
             StringJoin[
             "Semi-Infinite Rod, albedo problem, anisotropic scattering, \!\(\
\*SubscriptBox[\(L\), \(+\)]\)[x|", 
              ToString[$CellContext`n$$], "], \[Alpha] = ", 
              ToString[$CellContext`\[Alpha]$$], 
              ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
              ToString[$CellContext`\[CapitalSigma]t$$], ", g = ", 
              ToString[$CellContext`g$$]]}}, PlotRange -> All, ImageSize -> 
          500], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`g$$, {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5,
          0.7, 0.9}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
         12, 13, 14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{545., {240., 245.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6462655223025427`*^9, {3.64626555479628*^9, 3.646265559164009*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["N-th order Fluence / scalar flux", "Subsection",
 CellChangeTimes->{{3.617898988631413*^9, 3.617898994092989*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"SelectFirst", "[", 
         RowBox[{"simulations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "g"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nthL", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"13", "+", "numcollorders", "+", "1"}], ";;", 
          RowBox[{"13", "+", 
           RowBox[{"2", "numcollorders"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nthR", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"13", "+", 
           RowBox[{"2", " ", "numcollorders"}], "+", "2"}], ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"ppoints", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nthR", "[", 
              RowBox[{"[", 
               RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", 
             RowBox[{"nthL", "[", 
              RowBox[{"[", 
               RowBox[{"n", "+", "1"}], "]"}], "]"}]}], ",", "dx", ",", 
            "maxx", ",", "\[CapitalSigma]t"}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{
           "x", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "g", ",", 
            "n"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "maxx"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "\"\<x|7\>\"", "]"}], ","}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{
             "\"\<Semi-Infinite Rod, albedo problem, anisotropic scattering, \
\[Phi][x|\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}], "<>", 
              "\"\<], \[Alpha] = \>\"", "<>", 
              RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
              "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\"",
               "<>", 
              RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}], "<>", 
              "\"\<, g = \>\"", "<>", 
              RowBox[{"ToString", "[", "g", "]"}]}]}], "}"}]}], "}"}]}], ",", 
        
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "gs"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "numcollorders", "]"}], ",", "numcollorders", 
        ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6462656650391083`*^9, 3.6462656862587643`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = 0.3, $CellContext`n$$ = 
    9, $CellContext`\[Alpha]$$ = 0.95, $CellContext`\[CapitalSigma]t$$ = 3, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`g$$], {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5, 
      0.7, 0.9}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {500., {160., 164.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4775870$$ = 
    0, $CellContext`\[CapitalSigma]t$4775871$$ = 
    False, $CellContext`g$4775872$$ = 0, $CellContext`n$4775873$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = -0.9, $CellContext`n$$ = 
        1, $CellContext`\[Alpha]$$ = 0.1, $CellContext`\[CapitalSigma]t$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4775870$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4775871$$, False], 
        Hold[$CellContext`g$$, $CellContext`g$4775872$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$4775873$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, $CellContext`data = Part[
           
           SelectFirst[$CellContext`simulations, And[
            Part[#, 1] == $CellContext`\[Alpha]$$, 
             Part[#, 2] == $CellContext`\[CapitalSigma]t$$, 
             Part[#, 3] == $CellContext`g$$]& ], 4]; $CellContext`nthL = 
         Part[$CellContext`data, 
           Span[
           13 + $CellContext`numcollorders + 1, 13 + 
            2 $CellContext`numcollorders]]; $CellContext`nthR = 
         Part[$CellContext`data, 
           Span[13 + 2 $CellContext`numcollorders + 2, -1]]; Show[
          ListPlot[
           $CellContext`ppoints[
           Part[$CellContext`nthR, $CellContext`n$$ + 1] + 
            Part[$CellContext`nthL, $CellContext`n$$ + 
              1], $CellContext`dx, $CellContext`maxx, $CellContext`\
\[CapitalSigma]t$$], PlotRange -> All, PlotStyle -> PointSize[0.01]], 
          Plot[
           $CellContext`\[Phi][$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$, $CellContext`g$$, $CellContext`n$$], \
{$CellContext`x, 0, $CellContext`maxx}, PlotRange -> All], Frame -> True, 
          ImageSize -> 500, FrameLabel -> {{
             $CellContext`\[Phi]["x|7"], Null}, {$CellContext`x, 
             StringJoin[
             "Semi-Infinite Rod, albedo problem, anisotropic scattering, \
\[Phi][x|", 
              ToString[$CellContext`n$$], "], \[Alpha] = ", 
              ToString[$CellContext`\[Alpha]$$], 
              ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
              ToString[$CellContext`\[CapitalSigma]t$$], ", g = ", 
              ToString[$CellContext`g$$]]}}, PlotRange -> All], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`g$$, {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5,
          0.7, 0.9}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
         12, 13, 14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{545., {243., 248.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.646265686854753*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare moments of \[Phi]", "Subsection",
 CellChangeTimes->{{3.617779269834346*^9, 3.617779274641601*^9}}],

Cell["\<\
Divide these results, which are collision density moments, by \
\[CapitalSigma]t to produce radiance/fluence moments:\
\>", "Text",
 CellChangeTimes->{{3.617847370274527*^9, 3.617847402120873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"SelectFirst", "[", 
         RowBox[{"simulations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "g"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]moments", "=", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"{", 
          RowBox[{"data", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "}"}], "\[CapitalSigma]t"], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"nummoments", "-", "1"}]}], "}"}]}], "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"analytic", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Phi]m", "[", 
          RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "k", ",", "g"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "ks"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"j", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ks", ",", "analytic", ",", "\[Phi]moments"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<k\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], 
           "}"}], "}"}], ",", 
         RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], "\[IndentingNewLine]",
        "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "gs"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6177792806285133`*^9, 3.617779297336399*^9}, {
   3.617779343239357*^9, 3.6177794771281633`*^9}, {3.6177795098244753`*^9, 
   3.6177795247590523`*^9}, {3.617779555197104*^9, 3.617779656475761*^9}, {
   3.617779687007894*^9, 3.617779881109676*^9}, {3.617847356159178*^9, 
   3.617847361453464*^9}, {3.619594516589923*^9, 3.6195945170905647`*^9}, {
   3.619594713380765*^9, 3.619594735762917*^9}, 3.645068394199531*^9, 
   3.6462543369102907`*^9, {3.6462544012171173`*^9, 3.646254401505522*^9}, {
   3.646264766720869*^9, 3.6462647707855673`*^9}, {3.646264825291609*^9, 
   3.6462648255218563`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = 0.5, $CellContext`\[Alpha]$$ = 
    0.7, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`g$$], {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5, 
      0.7, 0.9}}}, Typeset`size$$ = {
    242., {91.134033203125, 96.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4682377$$ = 
    0, $CellContext`\[CapitalSigma]t$4682378$$ = 
    False, $CellContext`g$4682379$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = -0.9, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4682377$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4682378$$, False], 
        Hold[$CellContext`g$$, $CellContext`g$4682379$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, $CellContext`data = Part[
           
           SelectFirst[$CellContext`simulations, And[
            Part[#, 1] == $CellContext`\[Alpha]$$, 
             Part[#, 2] == $CellContext`\[CapitalSigma]t$$, 
             Part[#, 3] == $CellContext`g$$]& ], 
           4]; $CellContext`\[Phi]moments = N[{
             
             Part[$CellContext`data, 
              11]}/$CellContext`\[CapitalSigma]t$$]; $CellContext`ks = {
           Table[$CellContext`k, {$CellContext`k, 0, $CellContext`nummoments - 
             1}]}; $CellContext`analytic = Table[
           $CellContext`\[Phi]m[$CellContext`\[Alpha]$$, $CellContext`\
\[CapitalSigma]t$$, $CellContext`k, $CellContext`g$$], {$CellContext`k, \
$CellContext`ks}]; $CellContext`j = 
         Join[$CellContext`ks, $CellContext`analytic, \
$CellContext`\[Phi]moments]; TableForm[
          Join[{{"k", "analytic", "MC"}}, 
           Transpose[$CellContext`j]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`g$$, {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5,
          0.7, 0.9}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{287., {162., 167.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.617779832588072*^9, {3.617779869376008*^9, 3.6177798817119627`*^9}, {
   3.6178473088352737`*^9, 3.617847330769167*^9}, 3.617847361723319*^9, 
   3.618026897603917*^9, 3.618035300457242*^9, 3.619594068174963*^9, 
   3.619594213989615*^9, 3.619594517486966*^9, {3.6195946709229193`*^9, 
   3.619594685752365*^9}, 3.6195947362190523`*^9, 3.621374422621011*^9, {
   3.621374461501079*^9, 3.621374471782186*^9}, 3.621374593290991*^9, 
   3.625760818327333*^9, {3.625761010482192*^9, 3.625761016396119*^9}, 
   3.640936237036949*^9, 3.6410042089759274`*^9, 3.643952948659853*^9, 
   3.643953128159903*^9, 3.645066582831504*^9, 3.6450683948407917`*^9, 
   3.645070163756219*^9, 3.646173977134774*^9, 3.646254402640938*^9, 
   3.6462546884830513`*^9, 3.64626294879793*^9, 3.646264773012135*^9, 
   3.64626482570368*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided moments of \[Phi]", "Subsection",
 CellChangeTimes->{{3.646262916178207*^9, 3.646262920832403*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"SelectFirst", "[", 
         RowBox[{"simulations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "g"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]moments", "=", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"{", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"13", "+", "n"}], "]"}], "]"}], "}"}], 
         "\[CapitalSigma]t"], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"nummoments", "-", "1"}]}], "}"}]}], "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"analytic", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"N", "[", 
           RowBox[{"\[Phi]m", "[", 
            RowBox[{
            "\[Alpha]", ",", "\[CapitalSigma]t", ",", "k", ",", "g", ",", 
             "n"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "ks"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"j", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ks", ",", "analytic", ",", "\[Phi]moments"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<k\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], 
           "}"}], "}"}], ",", 
         RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], "\[IndentingNewLine]",
        "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "gs"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "numcollorders", "]"}], ",", "numcollorders", 
        ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.646254332711746*^9, 3.646254360739975*^9}, {
  3.6462546341534433`*^9, 3.6462546400025663`*^9}, {3.646265275996725*^9, 
  3.646265294484212*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = 0.3, $CellContext`n$$ = 
    3, $CellContext`\[Alpha]$$ = 0.7, $CellContext`\[CapitalSigma]t$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9, 0.95, 0.98, 
      0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`g$$], {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5, 
      0.7, 0.9}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {
    242., {89.134033203125, 94.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4709058$$ = 
    0, $CellContext`\[CapitalSigma]t$4709059$$ = 
    False, $CellContext`g$4709060$$ = 0, $CellContext`n$4709061$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = -0.9, $CellContext`n$$ = 
        1, $CellContext`\[Alpha]$$ = 0.1, $CellContext`\[CapitalSigma]t$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4709058$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4709059$$, False], 
        Hold[$CellContext`g$$, $CellContext`g$4709060$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$4709061$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, $CellContext`data = Part[
           
           SelectFirst[$CellContext`simulations, And[
            Part[#, 1] == $CellContext`\[Alpha]$$, 
             Part[#, 2] == $CellContext`\[CapitalSigma]t$$, 
             Part[#, 3] == $CellContext`g$$]& ], 
           4]; $CellContext`\[Phi]moments = N[{
             
             Part[$CellContext`data, 
              13 + $CellContext`n$$]}/$CellContext`\[CapitalSigma]t$$]; \
$CellContext`ks = {
           
           Table[$CellContext`k, {$CellContext`k, 0, $CellContext`nummoments - 
             1}]}; $CellContext`analytic = Table[
           Quiet[
            N[
             $CellContext`\[Phi]m[$CellContext`\[Alpha]$$, $CellContext`\
\[CapitalSigma]t$$, $CellContext`k, $CellContext`g$$, $CellContext`n$$]]], \
{$CellContext`k, $CellContext`ks}]; $CellContext`j = 
         Join[$CellContext`ks, $CellContext`analytic, \
$CellContext`\[Phi]moments]; TableForm[
          Join[{{"k", "analytic", "MC"}}, 
           Transpose[$CellContext`j]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 0.9,
          0.95, 0.98, 0.99, 0.999}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`g$$, {-0.9, -0.7, -0.5, -0.3, -0.1, 0.1, 0.3, 0.5,
          0.7, 0.9}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
         12, 13, 14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{287., {173., 178.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6450691030559998`*^9, 3.645070163703945*^9, 3.646173976984788*^9, {
   3.646254361680525*^9, 3.6462543784379463`*^9}, 3.6462545202789383`*^9, 
   3.646254640433272*^9, 3.646254688399544*^9, 3.646262948881361*^9, {
   3.646265284884398*^9, 3.646265294897929*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{971, 1032},
WindowMargins->{{Automatic, 55}, {Automatic, 34}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 283, 3, 148, "Title"],
Cell[865, 27, 408, 9, 129, "Text"],
Cell[CellGroupData[{
Cell[1298, 40, 143, 2, 64, "Section"],
Cell[1444, 44, 253, 5, 49, "Text"],
Cell[1700, 51, 122, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1859, 58, 113, 1, 51, "Subtitle"],
Cell[CellGroupData[{
Cell[1997, 63, 93, 1, 64, "Section"],
Cell[2093, 66, 381, 8, 87, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2511, 79, 105, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[2641, 84, 169, 2, 44, "Subsection"],
Cell[2813, 88, 957, 27, 54, "Input"],
Cell[CellGroupData[{
Cell[3795, 119, 275, 7, 28, "Input"],
Cell[4073, 128, 1448, 39, 54, "Output"]
}, Open  ]],
Cell[5536, 170, 630, 17, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6203, 192, 130, 1, 44, "Subsection"],
Cell[6336, 195, 628, 17, 35, "Input"],
Cell[6967, 214, 1304, 42, 86, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8308, 261, 95, 1, 44, "Subsection"],
Cell[8406, 264, 451, 12, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8894, 281, 111, 1, 44, "Subsection"],
Cell[9008, 284, 628, 18, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9673, 307, 95, 1, 44, "Subsection"],
Cell[9771, 310, 1782, 58, 106, "Input"],
Cell[11556, 370, 630, 18, 31, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12235, 394, 197, 3, 64, "Section"],
Cell[12435, 399, 416, 9, 28, "Input"],
Cell[12854, 410, 1386, 36, 131, "Input"],
Cell[CellGroupData[{
Cell[14265, 450, 271, 8, 28, "Input"],
Cell[14539, 460, 398, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14974, 472, 267, 8, 28, "Input"],
Cell[15244, 482, 231, 5, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15512, 492, 264, 8, 28, "Input"],
Cell[15779, 502, 392, 10, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16220, 518, 233, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[16478, 525, 125, 1, 44, "Subsection"],
Cell[16606, 528, 514, 10, 63, "Input"],
Cell[17123, 540, 772, 22, 80, "Input"],
Cell[17898, 564, 302, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[18225, 576, 1467, 38, 131, "Input"],
Cell[19695, 616, 4009, 77, 258, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23753, 699, 156, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[23934, 705, 2795, 75, 284, "Input"],
Cell[26732, 782, 3375, 64, 510, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30156, 852, 135, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[30316, 858, 12123, 267, 947, "Input"],
Cell[42442, 1127, 7066, 131, 1054, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49557, 1264, 123, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[49705, 1269, 4884, 124, 391, "Input"],
Cell[54592, 1395, 4871, 94, 502, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59512, 1495, 120, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[59657, 1500, 4488, 114, 352, "Input"],
Cell[64148, 1616, 4559, 86, 508, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68756, 1708, 113, 1, 44, "Subsection"],
Cell[68872, 1711, 207, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[69104, 1719, 3408, 84, 331, "Input"],
Cell[72515, 1805, 4297, 80, 346, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76861, 1891, 119, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[77005, 1896, 3333, 89, 331, "Input"],
Cell[80341, 1987, 4203, 82, 368, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
