(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     72743,       1804]
NotebookOptionsPosition[     69712,       1692]
NotebookOutlinePosition[     70070,       1708]
CellTagsIndexPosition[     70027,       1705]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Infinite Rod, Isotropic Point Source, Isotropic Scattering", "Title",
 CellChangeTimes->{{3.61742787362737*^9, 3.617427885266508*^9}}],

Cell[TextData[{
 "This is code to accompany the book:\n",
 StyleBox["A Hitchhiker\[CloseCurlyQuote]s Guide to Multiple Scattering\n", 
  "Subchapter"],
 StyleBox["\[Copyright] 2015", "Subsection"],
 StyleBox[" ", "Section"],
 StyleBox["Eugene d\[CloseCurlyQuote]Eon \nwww.eugenedeon.com", "Subsection"]
}], "Text",
 CellChangeTimes->{{3.6174286022468777`*^9, 3.617428710592918*^9}, 
   3.645060526514143*^9}],

Cell[CellGroupData[{

Cell["Path Setup", "Section",
 CellChangeTimes->{{3.640928920990849*^9, 3.64092892141395*^9}, {
  3.640928986491934*^9, 3.640928986905283*^9}}],

Cell["\<\
Put a file at ~/.hitchhikerpath with the path to your hitchhiker repo so that \
these worksheets can find the MC data from the C++ simulations for \
verification\
\>", "Text",
 CellChangeTimes->{{3.640928926126832*^9, 3.6409289600754013`*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"Import", "[", "\"\<~/.hitchhikerpath\>\"", "]"}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exponential random flight", "Chapter",
 CellChangeTimes->{{3.617427887473928*^9, 3.6174278904581738`*^9}}],

Cell[CellGroupData[{

Cell["Notation", "Section",
 CellChangeTimes->{{3.617428538130481*^9, 3.617428538753331*^9}}],

Cell["\<\
\[Alpha] - single-scattering albedo
\[CapitalSigma]t - extinction coefficient
x - position coordinate in rod (source at x = 0)\
\>", "Text",
 CellChangeTimes->{{3.617428487341361*^9, 3.617428516514864*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analytic solutions", "Section",
 CellChangeTimes->{{3.617428019371695*^9, 3.6174280209794273`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<infrodisopointisoscatter`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.646270167017658*^9, 3.646270178620537*^9}}],

Cell[BoxData["\<\"infrodisopointisoscatter`\"\>"], "Output",
 CellChangeTimes->{3.6462701790445223`*^9, 3.646270492489194*^9, 
  3.646270527282957*^9, 3.6462713053033237`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[OpenCurlyQuote]Radiance\[CloseCurlyQuote]", "Subsection",
 CellChangeTimes->{{3.6174307357157917`*^9, 3.617430742507958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LR", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Abs", "[", "x", "]"}]}], " ", 
      SqrtBox[
       RowBox[{"1", "-", "\[Alpha]"}]], " ", "\[CapitalSigma]t"}]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", "\[Alpha]"}]], " ", 
       RowBox[{"Sign", "[", "x", "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SqrtBox[
     RowBox[{"1", "-", "\[Alpha]"}]]}]]}]], "Input",
 CellChangeTimes->{{3.617430690623348*^9, 3.6174307057929173`*^9}, {
  3.617430826778767*^9, 3.617430831298792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LL", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Abs", "[", "x", "]"}]}], " ", 
      SqrtBox[
       RowBox[{"1", "-", "\[Alpha]"}]], " ", "\[CapitalSigma]t"}]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", "\[Alpha]"}]], " ", 
       RowBox[{"Sign", "[", "x", "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SqrtBox[
     RowBox[{"1", "-", "\[Alpha]"}]]}]]}]], "Input",
 CellChangeTimes->{{3.617430716019354*^9, 3.617430719357438*^9}, {
  3.61743083377562*^9, 3.617430837914253*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fluence", "Subsection",
 CellChangeTimes->{{3.6174280405395184`*^9, 3.617428041266676*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"x_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox[
      RowBox[{"1", "-", "\[Alpha]"}]]}]], 
   SuperscriptBox["E", 
    RowBox[{
     RowBox[{"-", "\[CapitalSigma]t"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", "\[Alpha]"}]], 
     RowBox[{"Abs", "[", "x", "]"}]}]]}]}]], "Input",
 CellChangeTimes->{{3.61742826600518*^9, 3.617428300462263*^9}, {
  3.6174283455645227`*^9, 3.617428382979632*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["n-th collided fluence", "Subsection",
 CellChangeTimes->{{3.618028583897595*^9, 3.618028587232552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"x_", ",", "n_", ",", "\[Alpha]_", ",", "\[CapitalSigma]t_"}], 
   "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "-", 
      FractionBox["1", "2"]}]], 
    SuperscriptBox["\[Alpha]", "n"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Abs", "[", "x", "]"}], "\[CapitalSigma]t"}], ")"}], 
     RowBox[{"n", "+", 
      FractionBox["1", "2"]}]], 
    RowBox[{"BesselK", "[", 
     RowBox[{
      RowBox[{"n", "+", 
       FractionBox["1", "2"]}], ",", 
      RowBox[{"\[CapitalSigma]t", " ", 
       RowBox[{"Abs", "[", "x", "]"}]}]}], "]"}]}], 
   RowBox[{
    SqrtBox["Pi"], 
    RowBox[{"Gamma", "[", 
     RowBox[{"n", "+", "1"}], "]"}]}]]}]], "Input",
 CellChangeTimes->{{3.618028819362002*^9, 3.618028820627399*^9}, {
  3.6180291691249523`*^9, 3.6180291991728563`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["moments", "Subsection",
 CellChangeTimes->{{3.617434940435688*^9, 3.617434941186858*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]m", "[", 
   RowBox[{"\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "k"]}], ")"}], " ", 
   SuperscriptBox["\[CapitalSigma]t", 
    RowBox[{
     RowBox[{"-", "1"}], "-", "k"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     FractionBox["k", "2"]}]], " ", 
   RowBox[{"k", "!"}]}]}]], "Input",
 CellChangeTimes->{{3.617434946155171*^9, 3.61743497664139*^9}, 
   3.617435010819428*^9, 3.6174353385228453`*^9, 3.617778861866281*^9, 
   3.61777966643909*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]m", "[", 
   RowBox[{"\[Alpha]_", ",", "\[CapitalSigma]t_", ",", "k_", ",", "n_"}], 
   "]"}], ":=", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "n"], 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "n"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "k"]}], ")"}], " ", 
     SuperscriptBox["\[CapitalSigma]t", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "k"}]], " ", 
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        FractionBox["k", "2"]}], ",", "n"}], "]"}], " ", 
     RowBox[{"k", "!"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.646261784080875*^9, 3.646261826435824*^9}, {
  3.646262034746467*^9, 3.646262035343235*^9}, {3.646262066866022*^9, 
  3.646262074092552*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["load MC data", "Section",
 CellChangeTimes->{{3.617427964847665*^9, 3.617427965662361*^9}, {
  3.6174280073412037`*^9, 3.617428007556081*^9}, {3.640936210100869*^9, 
  3.640936211771452*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ppoints", "[", 
   RowBox[{"xs_", ",", "dx_", ",", "maxx_", ",", "\[CapitalSigma]t_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "maxx"}], "+", 
        RowBox[{"dx", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", 
        RowBox[{"0.5", "dx"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "\[CapitalSigma]t"}], ")"}], 
        RowBox[{"xs", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"2", ";;", 
     RowBox[{"-", "2"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.617848413386137*^9, 3.6178484581160173`*^9}, {
   3.61959273772493*^9, 3.6195927529849243`*^9}, 3.646256598177155*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\<code/rod/infiniterod/Isotropicpointsource/data/infrod_isotropicpoint_\
isotropicscatter_exp*\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.617431703558316*^9, 3.61743173077596*^9}, {
   3.61959282254521*^9, 3.6195928356726227`*^9}, {3.6409361975771008`*^9, 
   3.640936201348721*^9}, 3.645065566454424*^9, 3.6462558913234873`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"index", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"x", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalSigma]t", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "12"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "data"}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simulations", "=", 
   RowBox[{"index", "/@", "fs"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.645065231793377*^9, 3.645065296029221*^9}, {
   3.6450653296918097`*^9, 3.6450653865106487`*^9}, 3.6450654361720257`*^9, {
   3.646255921487211*^9, 3.646255921557672*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphas", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "simulations"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.645065448960425*^9, 3.6450654746981783`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1`", ",", "0.3`", ",", "0.5`", ",", "0.7`", ",", "0.9`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6450654647633867`*^9, 3.645065474997116*^9}, 
   3.645070161322473*^9, 3.64617397571076*^9, 3.646254687365184*^9, {
   3.646255904165*^9, 3.646255925111535*^9}, 3.646256616423402*^9, 
   3.646262541193899*^9, 3.646270527647534*^9, 3.646271205801887*^9, 
   3.646271305561139*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"muts", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "simulations"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.645065539848353*^9, 3.645065542907295*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{
  3.64506554314834*^9, 3.645070161361624*^9, 3.6461739757283497`*^9, 
   3.646254687418363*^9, {3.646255904185261*^9, 3.646255925160824*^9}, 
   3.646256616474985*^9, 3.6462625412463512`*^9, 3.646270527687414*^9, 
   3.646271205855611*^9, 3.646271305579796*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numcollorders", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"simulations", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6462711467267323`*^9, 3.646271194585766*^9}, 
   3.646271283721418*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare Deterministic and MC", "Section",
 CellChangeTimes->{{3.617428104753593*^9, 3.6174281129212646`*^9}}],

Cell[CellGroupData[{

Cell["Internal distributions", "Subsection",
 CellChangeTimes->{{3.646256878123049*^9, 3.6462568812106247`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "maxx", ",", "dx", ",", "numcollorders", ",", 
         "nummoments", ",", "densmom", ",", "pointsCL", ",", "plotpointsCL", 
         ",", "pointsCR", ",", "plotpointsCR", ",", "plotpoints\[Phi]", ",", 
         "plot\[Phi]", ",", "plotLL", ",", "plotLR"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numcollorders", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nummoments", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pointsCL", " ", "=", " ", 
         RowBox[{"data", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "divide", " ", "by", " ", "\[CapitalSigma]t", " ", "to", " ", 
          "convert", " ", "collision", " ", "density", " ", "into", " ", 
          "L"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"plotpointsCL", "=", 
         RowBox[{"ppoints", "[", 
          RowBox[{
          "pointsCL", ",", "dx", ",", "maxx", ",", "\[CapitalSigma]t"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointsCR", " ", "=", " ", 
         RowBox[{"data", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plotpointsCR", "=", 
         RowBox[{"ppoints", "[", 
          RowBox[{
          "pointsCR", ",", "dx", ",", "maxx", ",", "\[CapitalSigma]t"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "divide", " ", "by", " ", "\[CapitalSigma]t", " ", "to", " ", 
          "convert", " ", "collision", " ", "density", " ", "into", " ", 
          "fluence"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"plotpoints\[Phi]", "=", 
         RowBox[{"ppoints", "[", 
          RowBox[{
           RowBox[{"pointsCL", "+", "pointsCR"}], ",", "dx", ",", "maxx", ",",
            "\[CapitalSigma]t"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"plot\[Phi]", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"plotpoints\[Phi]", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "maxx"}], ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Phi]", "[", "x", "]"}], ","}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                "\"\<Infinite Rod, isotropic point, isotropic scattering, \
fluence \[Phi][x], \[Alpha] = \>\"", "<>", 
                 RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                 "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\
\"", "<>", 
                 RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
               "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"plotLL", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"plotpointsCL", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"LL", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "maxx"}], ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "maxx"}], ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["L", "-"], "[", "x", "]"}], ","}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                "\"\<Infinite Rod, isotropic point, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(-\)]\)[x], \[Alpha] = \>\"", "<>", 
                 RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                 "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\
\"", "<>", 
                 RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"plotLR", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"plotpointsCR", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"LR", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "maxx"}], ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", 
              RowBox[{"x", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "maxx"}], ",", "maxx"}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["L", "+"], "[", "x", "]"}], ","}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                "\"\<Infinite Rod, isotropic point, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x], \[Alpha] = \>\"", "<>", 
                 RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                 "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \>\
\"", "<>", 
                 RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"GraphicsGrid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "plot\[Phi]", "}"}], ",", 
             RowBox[{"{", "plotLL", "}"}], ",", 
             RowBox[{"{", "plotLR", "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6174281170020113`*^9, 3.61742813267981*^9}, 
   3.6174287994794273`*^9, {3.617428838302623*^9, 3.617428878809485*^9}, {
   3.6174289474455023`*^9, 3.61742896885219*^9}, {3.61742923797204*^9, 
   3.617429325246893*^9}, {3.617429373536989*^9, 3.617429375936674*^9}, {
   3.617429430039774*^9, 3.617429597670169*^9}, {3.617429724574465*^9, 
   3.6174297347942553`*^9}, {3.617429794822505*^9, 3.6174298315174522`*^9}, {
   3.6174298677304993`*^9, 3.6174298817845984`*^9}, {3.617429917431849*^9, 
   3.617429978970625*^9}, {3.617430046618482*^9, 3.6174301175661373`*^9}, {
   3.6174302274511757`*^9, 3.617430269908132*^9}, {3.617430851237011*^9, 
   3.61743094294977*^9}, {3.617431018010861*^9, 3.6174310182802477`*^9}, {
   3.617431054641918*^9, 3.6174310955544443`*^9}, {3.617431738710396*^9, 
   3.617431780737298*^9}, {3.617431916426394*^9, 3.617431938292404*^9}, {
   3.617432017592498*^9, 3.61743203121756*^9}, {3.617434253945896*^9, 
   3.617434276351254*^9}, {3.617434334762925*^9, 3.617434349959379*^9}, {
   3.617434549029696*^9, 3.617434585144499*^9}, {3.6174346161354094`*^9, 
   3.6174346244125147`*^9}, {3.617434842916192*^9, 3.617434849707287*^9}, {
   3.617847326305366*^9, 3.61784732690473*^9}, 3.617848051268721*^9, {
   3.617848167301262*^9, 3.6178481676284246`*^9}, {3.61784850895185*^9, 
   3.617848563337233*^9}, {3.617898951271072*^9, 3.617898951610284*^9}, {
   3.618035560623592*^9, 3.618035561301065*^9}, {3.6462564759754543`*^9, 
   3.646256500112418*^9}, {3.646270684054685*^9, 3.646270758625198*^9}, {
   3.646271217010194*^9, 3.646271220321653*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.7, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}}, Typeset`size$$ = {
    500., {447., 451.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Alpha]$32652$$ = 
    0, $CellContext`\[CapitalSigma]t$32653$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$32652$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$32653$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`maxx$, $CellContext`dx$, \
$CellContext`numcollorders$, $CellContext`nummoments$, $CellContext`densmom$, \
$CellContext`pointsCL$, $CellContext`plotpointsCL$, $CellContext`pointsCR$, \
$CellContext`plotpointsCR$, $CellContext`plotpoints\[Phi]$, $CellContext`plot\
\[Phi]$, $CellContext`plotLL$, $CellContext`plotLR$}, $CellContext`data$ = 
          Part[
            
            SelectFirst[$CellContext`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`maxx$ = 
          Part[$CellContext`data$, 2, 5]; $CellContext`dx$ = 
          Part[$CellContext`data$, 2, 7]; $CellContext`numcollorders$ = 
          Part[$CellContext`data$, 2, 11]; $CellContext`nummoments$ = 
          Part[$CellContext`data$, 2, 13]; $CellContext`pointsCL$ = 
          Part[$CellContext`data$, 
            4]; $CellContext`plotpointsCL$ = \
$CellContext`ppoints[$CellContext`pointsCL$, $CellContext`dx$, \
$CellContext`maxx$, $CellContext`\[CapitalSigma]t$$]; $CellContext`pointsCR$ = 
          Part[$CellContext`data$, 
            6]; $CellContext`plotpointsCR$ = \
$CellContext`ppoints[$CellContext`pointsCR$, $CellContext`dx$, \
$CellContext`maxx$, $CellContext`\[CapitalSigma]t$$]; $CellContext`plotpoints\
\[Phi]$ = $CellContext`ppoints[$CellContext`pointsCL$ + \
$CellContext`pointsCR$, $CellContext`dx$, $CellContext`maxx$, $CellContext`\
\[CapitalSigma]t$$]; $CellContext`plot\[Phi]$ = Show[
            
            ListPlot[$CellContext`plotpoints\[Phi]$, PlotRange -> All, 
             PlotStyle -> PointSize[0.01]], 
            Plot[
             $CellContext`\[Phi][$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$], {$CellContext`x, -$CellContext`maxx$, \
$CellContext`maxx$}, PlotRange -> All], Frame -> True, FrameLabel -> {{
               $CellContext`\[Phi][$CellContext`x], Null}, {$CellContext`x, 
               StringJoin[
               "Infinite Rod, isotropic point, isotropic scattering, fluence \
\[Phi][x], \[Alpha] = ", 
                ToString[$CellContext`\[Alpha]$$], 
                ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
                
                ToString[$CellContext`\[CapitalSigma]t$$]]}}]; \
$CellContext`plotLL$ = Show[
            
            ListPlot[$CellContext`plotpointsCL$, PlotRange -> All, PlotStyle -> 
             PointSize[0.01]], 
            Plot[
             $CellContext`LL[$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$], {$CellContext`x, -$CellContext`maxx$, \
$CellContext`maxx$}, PlotRange -> All], 
            Plot[
             $CellContext`\[Phi][$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$], {$CellContext`x, -$CellContext`maxx$, \
$CellContext`maxx$}, PlotRange -> All, PlotStyle -> Dashed], Frame -> True, 
            FrameLabel -> {{
               SubMinus[$CellContext`L][$CellContext`x], 
               Null}, {$CellContext`x, 
               StringJoin[
               "Infinite Rod, isotropic point, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(-\)]\)[x], \[Alpha] = ", 
                ToString[$CellContext`\[Alpha]$$], 
                ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
                ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> 
            All]; $CellContext`plotLR$ = Show[
            
            ListPlot[$CellContext`plotpointsCR$, PlotRange -> All, PlotStyle -> 
             PointSize[0.01]], 
            Plot[
             $CellContext`LR[$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$], {$CellContext`x, -$CellContext`maxx$, \
$CellContext`maxx$}, PlotRange -> All], 
            Plot[
             $CellContext`\[Phi][$CellContext`x, $CellContext`\[Alpha]$$, \
$CellContext`\[CapitalSigma]t$$], {$CellContext`x, -$CellContext`maxx$, \
$CellContext`maxx$}, PlotRange -> All, PlotStyle -> Dashed], Frame -> True, 
            FrameLabel -> {{
               SubPlus[$CellContext`L][$CellContext`x], 
               Null}, {$CellContext`x, 
               StringJoin[
               "Infinite Rod, isotropic point, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x], \[Alpha] = ", 
                ToString[$CellContext`\[Alpha]$$], 
                ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
                ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> 
            All]; Show[
           
           GraphicsGrid[{{$CellContext`plot\[Phi]$}, {$CellContext`plotLL$}, \
{$CellContext`plotLR$}}], ImageSize -> 500]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 
         0.9}}, {$CellContext`\[CapitalSigma]t$$, {1, 3}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{545., {502., 507.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.61742928183463*^9, 3.6174293258331547`*^9}, 
   3.617429436318664*^9, {3.61742948106245*^9, 3.6174295009489727`*^9}, {
   3.617429549372438*^9, 3.617429598132875*^9}, {3.617429727942461*^9, 
   3.617429735895954*^9}, 3.617429800033937*^9, 3.617429832097906*^9, {
   3.617429874504074*^9, 3.617429882154498*^9}, 3.617429920022324*^9, {
   3.617429950258304*^9, 3.6174299799852943`*^9}, {3.6174300589071608`*^9, 
   3.617430117980332*^9}, {3.6174302282216253`*^9, 3.6174302706886377`*^9}, {
   3.617430871226499*^9, 3.6174309434694443`*^9}, 3.617431018710215*^9, {
   3.6174310600334377`*^9, 3.617431096079486*^9}, {3.61743174071297*^9, 
   3.61743178146768*^9}, 3.617431939072937*^9, {3.617432023877068*^9, 
   3.617432031820962*^9}, {3.617434265407374*^9, 3.6174342766717987`*^9}, {
   3.617434339799399*^9, 3.6174343511449547`*^9}, {3.617434565777495*^9, 
   3.617434585410145*^9}, 3.617434850608314*^9, 3.617435047387048*^9, 
   3.617779205752945*^9, {3.617847308432588*^9, 3.6178473273725863`*^9}, 
   3.6178480525007877`*^9, 3.617848167873561*^9, {3.617848523620203*^9, 
   3.617848532847191*^9}, 3.617848563566896*^9, 3.617898951835388*^9, 
   3.618026897361377*^9, 3.618035300220717*^9, 3.618035562256834*^9, 
   3.640929115385881*^9, 3.646256500631263*^9, 3.646256616522751*^9, 
   3.646262542820717*^9, 3.646270529303467*^9, {3.646270730167371*^9, 
   3.646270759502342*^9}, 3.646271305669959*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare moments of \[Phi]", "Subsection",
 CellChangeTimes->{{3.617779269834346*^9, 3.617779274641601*^9}}],

Cell["\<\
Divide these results, which are collision density moments, by \
\[CapitalSigma]t to produce radiance/fluence moments:\
\>", "Text",
 CellChangeTimes->{{3.617847370274527*^9, 3.617847402120873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "\[Phi]moments", ",", "ks", ",", "analytic", ",", "j", 
         ",", "nummoments"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nummoments", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]moments", "=", 
         FractionBox[
          RowBox[{"{", 
           RowBox[{"data", "[", 
            RowBox[{"[", "8", "]"}], "]"}], "}"}], "\[CapitalSigma]t"]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"ks", "=", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"nummoments", "-", "1"}]}], "}"}]}], "]"}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"analytic", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\[Phi]m", "[", 
            RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "k"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "ks"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ks", ",", "analytic", ",", "\[Phi]moments"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "\"\<k\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], "}"}],
             "}"}], ",", 
           RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6177792806285133`*^9, 3.617779297336399*^9}, {
  3.617779343239357*^9, 3.6177794771281633`*^9}, {3.6177795098244753`*^9, 
  3.6177795247590523`*^9}, {3.617779555197104*^9, 3.617779656475761*^9}, {
  3.617779687007894*^9, 3.617779881109676*^9}, {3.617847356159178*^9, 
  3.617847361453464*^9}, {3.646256807605074*^9, 3.646256857829979*^9}, {
  3.646270829705825*^9, 3.6462708454917793`*^9}, {3.646270883711061*^9, 
  3.6462708887944107`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.7, $CellContext`\[CapitalSigma]t$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}}, Typeset`size$$ = {
    219., {88.134033203125, 93.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$32848$$ = 
    0, $CellContext`\[CapitalSigma]t$32849$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$32848$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$32849$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`\[Phi]moments$, \
$CellContext`ks$, $CellContext`analytic$, $CellContext`j$, \
$CellContext`nummoments$}, $CellContext`data$ = Part[
            
            SelectFirst[$CellContext`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`nummoments$ = 
          Part[$CellContext`data$, 2, 13]; $CellContext`\[Phi]moments$ = {
             
             Part[$CellContext`data$, 
              8]}/$CellContext`\[CapitalSigma]t$$; $CellContext`ks$ = {
            
            Table[$CellContext`k, {$CellContext`k, 
              0, $CellContext`nummoments$ - 1}]}; $CellContext`analytic$ = 
          Table[
            $CellContext`\[Phi]m[$CellContext`\[Alpha]$$, $CellContext`\
\[CapitalSigma]t$$, $CellContext`k], {$CellContext`k, $CellContext`ks$}]; \
$CellContext`j$ = 
          Join[$CellContext`ks$, $CellContext`analytic$, \
$CellContext`\[Phi]moments$]; TableForm[
           Join[{{"k", "analytic", "MC"}}, 
            Transpose[$CellContext`j$]]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 
         0.9}}, {$CellContext`\[CapitalSigma]t$$, {1, 3}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{264., {144., 149.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.617779832588072*^9, {3.617779869376008*^9, 3.6177798817119627`*^9}, {
   3.6178473088352737`*^9, 3.617847330769167*^9}, 3.617847361723319*^9, 
   3.618026897603917*^9, 3.618035300457242*^9, 3.640929115543583*^9, 
   3.646256616780963*^9, 3.646256829637992*^9, 3.646261847614751*^9, 
   3.646262543199101*^9, 3.646270529820941*^9, 3.6462708469181356`*^9, 
   3.646270892928733*^9, 3.646271305834215*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["nth-collided moments of \[Phi]", "Subsection",
 CellChangeTimes->{{3.646256889082205*^9, 3.6462568938891897`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "\[Phi]moments", ",", "ks", ",", "analytic", ",", "j", 
         ",", "nummoments"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nummoments", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]moments", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"{", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"10", "+", "n"}], "]"}], "]"}], "}"}], 
           "\[CapitalSigma]t"], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ks", "=", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"nummoments", "-", "1"}]}], "}"}]}], "]"}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"analytic", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"N", "[", 
             RowBox[{"\[Phi]m", "[", 
              RowBox[{
              "\[Alpha]", ",", "\[CapitalSigma]t", ",", "k", ",", "n"}], 
              "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "ks"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ks", ",", "analytic", ",", "\[Phi]moments"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "\"\<k\>\"", ",", "\"\<analytic\>\"", ",", "\"\<MC\>\""}], "}"}],
             "}"}], ",", 
           RowBox[{"Transpose", "[", "j", "]"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "numcollorders", "]"}], ",", "numcollorders", 
        ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6462569332582083`*^9, 3.646256933399331*^9}, {
  3.646270902981992*^9, 3.646270933467203*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 3, $CellContext`\[Alpha]$$ = 
    0.5, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {
    218., {88.134033203125, 93.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$32876$$ = 
    0, $CellContext`\[CapitalSigma]t$32877$$ = False, $CellContext`n$32878$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 1, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$32876$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$32877$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$32878$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`\[Phi]moments$, \
$CellContext`ks$, $CellContext`analytic$, $CellContext`j$, \
$CellContext`nummoments$}, $CellContext`data$ = Part[
            
            SelectFirst[$CellContext`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`nummoments$ = 
          Part[$CellContext`data$, 2, 13]; $CellContext`\[Phi]moments$ = N[{
              
              Part[$CellContext`data$, 
               10 + $CellContext`n$$]}/$CellContext`\[CapitalSigma]t$$]; \
$CellContext`ks$ = {
            
            Table[$CellContext`k, {$CellContext`k, 
              0, $CellContext`nummoments$ - 1}]}; $CellContext`analytic$ = 
          Table[
            Quiet[
             N[
              $CellContext`\[Phi]m[$CellContext`\[Alpha]$$, $CellContext`\
\[CapitalSigma]t$$, $CellContext`k, $CellContext`n$$]]], {$CellContext`k, \
$CellContext`ks$}]; $CellContext`j$ = 
          Join[$CellContext`ks$, $CellContext`analytic$, \
$CellContext`\[Phi]moments$]; TableForm[
           Join[{{"k", "analytic", "MC"}}, 
            Transpose[$CellContext`j$]]]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 
         0.9}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
         14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{263., {158., 163.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.646261875042007*^9, 3.646262543277142*^9, 
  3.6462705298885937`*^9, 3.646270910345635*^9, 3.646271305912662*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["N-th order Radiance/Angular flux", "Subsection",
 CellChangeTimes->{{3.6178474490715647`*^9, 3.617847458534074*^9}, {
  3.617898905922576*^9, 3.617898912785017*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "nthL", ",", "nthR", ",", "numcollorders", ",", "LnR", 
         ",", "maxx", ",", "dx"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numcollorders", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthL", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"10", "+", "numcollorders", "+", "1"}], ";;", 
            RowBox[{"10", "+", 
             RowBox[{"2", "numcollorders"}]}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthR", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"10", "+", 
             RowBox[{"2", " ", "numcollorders"}], "+", "2"}], ";;", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{"c", ",", "x"}], "]"}], ";", 
        RowBox[{"LnR", "=", 
         RowBox[{
          RowBox[{"SeriesCoefficient", "[", 
           RowBox[{
            RowBox[{"LR", "[", 
             RowBox[{"x", ",", "c", ",", "\[CapitalSigma]t"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"c", ",", "0", ",", "n"}], "}"}]}], "]"}], 
          SuperscriptBox["\[Alpha]", "n"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"ppoints", "[", 
             RowBox[{
              RowBox[{"nthR", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "dx", ",", "maxx",
               ",", "\[CapitalSigma]t"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{"LnR", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "maxx"}], ",", "maxx"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["L", "+"], "[", "\"\<x|2\>\"", "]"}], ","}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
               "\"\<Infinite Rod, isotropic point, isotropic scattering, \!\(\
\*SubscriptBox[\(L\), \(+\)]\)[x|\>\"", "<>", 
                RowBox[{"ToString", "[", "n", "]"}], "<>", 
                "\"\<], \[Alpha] = \>\"", "<>", 
                RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \
\>\"", "<>", 
                RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "numcollorders", "]"}], ",", "numcollorders", 
        ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6462621975207987`*^9, 3.646262237309628*^9, {3.6462622779777737`*^9, 
   3.646262293471649*^9}, {3.6462713374758873`*^9, 3.646271363205092*^9}, {
   3.646271395987535*^9, 3.646271472045499*^9}, {3.646271621261757*^9, 
   3.646271621586891*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 8, $CellContext`\[Alpha]$$ = 
    0.9, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {500., {159., 164.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$58625$$ = 
    0, $CellContext`\[CapitalSigma]t$58626$$ = False, $CellContext`n$58627$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 1, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$58625$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$58626$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$58627$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`nthL$, $CellContext`nthR$, \
$CellContext`numcollorders$, $CellContext`LnR$, $CellContext`maxx$, \
$CellContext`dx$}, $CellContext`data$ = Part[
            
            SelectFirst[$CellContext`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`numcollorders$ = 
          Part[$CellContext`data$, 2, 11]; $CellContext`maxx$ = 
          Part[$CellContext`data$, 2, 5]; $CellContext`dx$ = 
          Part[$CellContext`data$, 2, 7]; $CellContext`nthL$ = 
          Part[$CellContext`data$, 
            Span[
            10 + $CellContext`numcollorders$ + 1, 10 + 
             2 $CellContext`numcollorders$]]; $CellContext`nthR$ = 
          Part[$CellContext`data$, 
            Span[10 + 2 $CellContext`numcollorders$ + 2, -1]]; 
         Clear[$CellContext`c, $CellContext`x]; $CellContext`LnR$ = 
          SeriesCoefficient[
             $CellContext`LR[$CellContext`x, $CellContext`c, $CellContext`\
\[CapitalSigma]t$$], {$CellContext`c, 
              0, $CellContext`n$$}] $CellContext`\[Alpha]$$^$CellContext`n$$; 
         Show[
           ListPlot[
            $CellContext`ppoints[
             
             Part[$CellContext`nthR$, $CellContext`n$$ + 
              1], $CellContext`dx$, $CellContext`maxx$, $CellContext`\
\[CapitalSigma]t$$], PlotRange -> All, PlotStyle -> PointSize[0.01]], 
           
           Plot[$CellContext`LnR$, {$CellContext`x, -$CellContext`maxx$, \
$CellContext`maxx$}, PlotRange -> All], Frame -> True, FrameLabel -> {{
              SubPlus[$CellContext`L]["x|2"], Null}, {$CellContext`x, 
              StringJoin[
              "Infinite Rod, isotropic point, isotropic scattering, \
\!\(\*SubscriptBox[\(L\), \(+\)]\)[x|", 
               ToString[$CellContext`n$$], "], \[Alpha] = ", 
               ToString[$CellContext`\[Alpha]$$], 
               ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
               ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> All,
            ImageSize -> 500]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 
         0.9}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
         14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{545., {228., 233.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.646262238476614*^9, {3.646262282968734*^9, 3.646262293901029*^9}, 
   3.646262543360508*^9, 3.646270529971002*^9, 3.6462713059959106`*^9, 
   3.646271481896624*^9, 3.646271622017563*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["N-th order Fluence / scalar flux", "Subsection",
 CellChangeTimes->{{3.617898988631413*^9, 3.617898994092989*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "simulations", "]"}], ">", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "nthL", ",", "nthR", ",", "numcollorders", ",", "maxx", 
         ",", "dx"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", 
           RowBox[{"simulations", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
               "\[CapitalSigma]t"}]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numcollorders", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "11"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthL", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"10", "+", "numcollorders", "+", "1"}], ";;", 
            RowBox[{"10", "+", 
             RowBox[{"2", "numcollorders"}]}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nthR", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"10", "+", 
             RowBox[{"2", " ", "numcollorders"}], "+", "2"}], ";;", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"ppoints", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nthR", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", 
               RowBox[{"nthL", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}]}], ",", "dx", ",", 
              "maxx", ",", "\[CapitalSigma]t"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"PointSize", "[", ".01", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{
             "x", ",", "n", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "maxx"}], ",", "maxx"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Phi]", "[", "\"\<x|7\>\"", "]"}], ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
               "\"\<Infinite Rod, isotropic point, isotropic scattering, \
\[Phi][x|\>\"", "<>", 
                RowBox[{"ToString", "[", "n", "]"}], "<>", 
                "\"\<], \[Alpha] = \>\"", "<>", 
                RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", 
                "\"\<, \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = \
\>\"", "<>", 
                RowBox[{"ToString", "[", "\[CapitalSigma]t", "]"}]}]}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
     "Text", "[", 
      "\"\<Uh oh!  Couldn't find MC data.  Try to evaluate this entire \
notebook and ensure the data path is setup correctly.\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "alphas"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]t", ",", "muts"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "numcollorders", "]"}], ",", "numcollorders", 
        ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.646262414938102*^9, 3.646262440976831*^9}, {
  3.6462624712005444`*^9, 3.6462624717430468`*^9}, {3.646271516211178*^9, 
  3.646271556135399*^9}, {3.646271602774489*^9, 3.646271605356247*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 3, $CellContext`\[Alpha]$$ = 
    0.3, $CellContext`\[CapitalSigma]t$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Alpha]$$], {0.1, 0.3, 0.5, 0.7, 0.9}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1, 3}}, {
      Hold[$CellContext`n$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20}}}, Typeset`size$$ = {500., {160., 164.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$57796$$ = 
    0, $CellContext`\[CapitalSigma]t$57797$$ = False, $CellContext`n$57798$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 1, $CellContext`\[Alpha]$$ = 
        0.1, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$57796$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$57797$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$57798$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      If[Length[$CellContext`simulations] > 0, 
        Module[{$CellContext`data$, $CellContext`nthL$, $CellContext`nthR$, \
$CellContext`numcollorders$, $CellContext`maxx$, $CellContext`dx$}, \
$CellContext`data$ = Part[
            
            SelectFirst[$CellContext`simulations, And[
             Part[#, 1] == $CellContext`\[Alpha]$$, 
              Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ], 
            3]; $CellContext`numcollorders$ = 
          Part[$CellContext`data$, 2, 11]; $CellContext`maxx$ = 
          Part[$CellContext`data$, 2, 5]; $CellContext`dx$ = 
          Part[$CellContext`data$, 2, 7]; $CellContext`nthL$ = 
          Part[$CellContext`data$, 
            Span[
            10 + $CellContext`numcollorders$ + 1, 10 + 
             2 $CellContext`numcollorders$]]; $CellContext`nthR$ = 
          Part[$CellContext`data$, 
            Span[10 + 2 $CellContext`numcollorders$ + 2, -1]]; Show[
           ListPlot[
            $CellContext`ppoints[
            Part[$CellContext`nthR$, $CellContext`n$$ + 1] + 
             Part[$CellContext`nthL$, $CellContext`n$$ + 
               1], $CellContext`dx$, $CellContext`maxx$, $CellContext`\
\[CapitalSigma]t$$], PlotRange -> All, PlotStyle -> PointSize[0.01]], 
           Plot[
            $CellContext`\[Phi][$CellContext`x, $CellContext`n$$, \
$CellContext`\[Alpha]$$, $CellContext`\[CapitalSigma]t$$], {$CellContext`x, \
-$CellContext`maxx$, $CellContext`maxx$}, PlotRange -> All], Frame -> True, 
           FrameLabel -> {{
              $CellContext`\[Phi]["x|7"], Null}, {$CellContext`x, 
              StringJoin[
              "Infinite Rod, isotropic point, isotropic scattering, \
\[Phi][x|", 
               ToString[$CellContext`n$$], "], \[Alpha] = ", 
               ToString[$CellContext`\[Alpha]$$], 
               ", \!\(\*SubscriptBox[\(\[CapitalSigma]\), \(t\)]\) = ", 
               ToString[$CellContext`\[CapitalSigma]t$$]]}}, PlotRange -> All,
            ImageSize -> 500]], 
        Text[
        "Uh oh!  Couldn't find MC data.  Try to evaluate this entire notebook \
and ensure the data path is setup correctly."]], 
      "Specifications" :> {{$CellContext`\[Alpha]$$, {0.1, 0.3, 0.5, 0.7, 
         0.9}}, {$CellContext`\[CapitalSigma]t$$, {1, 
         3}}, {$CellContext`n$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
         14, 15, 16, 17, 18, 19, 20}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{545., {228., 233.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.646262472373905*^9, 3.6462625435769997`*^9, 
  3.646270530171324*^9, 3.646271306536333*^9, 3.6462715638213463`*^9, 
  3.646271605705817*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 CellChangeTimes->{{3.646270483968256*^9, 3.6462704852642603`*^9}}],

Cell[BoxData["\<\"infrodisopointisoscatter`\"\>"], "Output",
 CellChangeTimes->{3.646270485720293*^9, 3.6462705302719297`*^9, 
  3.6462713068125553`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1092, 1124},
WindowMargins->{{12, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 140, 1, 92, "Title"],
Cell[723, 25, 408, 9, 129, "Text"],
Cell[CellGroupData[{
Cell[1156, 38, 143, 2, 64, "Section"],
Cell[1302, 42, 253, 5, 30, "Text"],
Cell[1558, 49, 122, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1717, 56, 112, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[1854, 61, 93, 1, 64, "Section"],
Cell[1950, 64, 216, 5, 68, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2203, 74, 105, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[2333, 79, 156, 2, 28, "Input"],
Cell[2492, 83, 175, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2704, 90, 133, 1, 44, "Subsection"],
Cell[2840, 93, 737, 22, 65, "Input"],
Cell[3580, 117, 734, 22, 65, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4351, 144, 97, 1, 44, "Subsection"],
Cell[4451, 147, 540, 16, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5028, 168, 109, 1, 44, "Subsection"],
Cell[5140, 171, 919, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6096, 205, 95, 1, 44, "Subsection"],
Cell[6194, 208, 764, 23, 48, "Input"],
Cell[6961, 233, 955, 29, 48, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7965, 268, 197, 3, 64, "Section"],
Cell[8165, 273, 948, 28, 28, "Input"],
Cell[9116, 303, 427, 9, 28, "Input"],
Cell[9546, 314, 1182, 31, 114, "Input"],
Cell[CellGroupData[{
Cell[10753, 349, 271, 8, 28, "Input"],
Cell[11027, 359, 423, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11487, 372, 267, 8, 28, "Input"],
Cell[11757, 382, 355, 7, 28, "Output"]
}, Open  ]],
Cell[12127, 392, 378, 11, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12542, 408, 115, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[12682, 413, 112, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[12819, 418, 12233, 267, 947, "Input"],
Cell[25055, 687, 8230, 149, 1026, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33334, 842, 113, 1, 44, "Subsection"],
Cell[33450, 845, 207, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[33682, 853, 3553, 87, 387, "Input"],
Cell[37238, 942, 3696, 73, 310, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40983, 1021, 120, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[41128, 1026, 3633, 94, 387, "Input"],
Cell[44764, 1122, 3852, 77, 338, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48665, 1205, 171, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[48861, 1211, 5585, 137, 447, "Input"],
Cell[54449, 1350, 4827, 93, 478, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59325, 1449, 120, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[59470, 1454, 5280, 130, 403, "Input"],
Cell[64753, 1586, 4583, 88, 478, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69373, 1679, 119, 2, 28, "Input"],
Cell[69495, 1683, 153, 2, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
